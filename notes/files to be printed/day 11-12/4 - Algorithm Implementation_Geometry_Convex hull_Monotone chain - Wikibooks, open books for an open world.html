<!DOCTYPE html>
<!-- saved from url=(0090)https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain -->
<html class="client-js ve-not-available" lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Algorithm Implementation/Geometry/Convex hull/Monotone chain - Wikibooks, open books for an open world</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain","wgTitle":"Algorithm Implementation/Geometry/Convex hull/Monotone chain","wgCurRevisionId":3509164,"wgRevisionId":3509164,"wgArticleId":244493,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Book:Algorithm Implementation"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain","wgRelevantArticleId":244493,"wgRequestId":"XI99bQpAME0AAFT9OQkAAABH","wgCSPNonce":false,"wgIsProbablyEditable":true,"wgRelevantPageIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgFlaggedRevsParams":{"tags":{"value":{"levels":3,"quality":2,"pristine":3}}},"wgStableRevisionId":3509164,"wgCategoryTreePageCategoryOptions":"{\"mode\":0,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}","wgWikiEditorEnabledModules":[],"wgBetaFeaturesFeatures":[],"wgMediaViewerOnClick":true,"wgMediaViewerEnabledByDefault":true,"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en","usePageImages":false,"usePageDescriptions":true},"wgMFDisplayWikibaseDescriptions":{"search":true,"nearby":true,"watchlist":true,"tagline":false},"wgWMESchemaEditAttemptStepOversample":false,"wgPoweredByHHVM":true,"wgULSCurrentAutonym":"English","wgNoticeProject":"wikibooks","wgCentralNoticeCookiesToDelete":[],"wgCentralNoticeCategoriesUsingLegacy":["Fundraising","fundraising"],"wgScoreNoteLanguages":{"arabic":"العربية","catalan":"català","deutsch":"Deutsch","english":"English","espanol":"español","italiano":"italiano","nederlands":"Nederlands","norsk":"norsk","portugues":"português","suomi":"suomi","svenska":"svenska","vlaams":"West-Vlams"},"wgScoreDefaultNoteLanguage":"nederlands","wgCentralAuthMobileDomain":false,"wgCodeMirrorEnabled":true,"wgVisualEditorToolbarScrollOffset":0,"wgVisualEditorUnsupportedEditParams":["undo","undoafter","veswitched"],"wgEditSubmitButtonLabelPublish":true});mw.loader.state({"ext.globalCssJs.user.styles":"ready","ext.globalCssJs.site.styles":"ready","site.styles":"ready","noscript":"ready","user.styles":"ready","ext.globalCssJs.user":"ready","ext.globalCssJs.site":"ready","user":"ready","user.options":"ready","user.tokens":"loading","ext.math.styles":"ready","ext.pygments":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.toc.styles":"ready","wikibase.client.init":"ready","ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.uls.interlanguage":"ready","ext.wikimediaBadges":"ready","ext.3d.styles":"ready","ext.flaggedRevs.basic":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@0tffind",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});RLPAGEMODULES=["ext.math.scripts","site","mediawiki.page.startup","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","ext.gadget.wikidialog","ext.gadget.commons-file","ext.centralauth.centralautologin","mmv.head","mmv.bootstrap.autostart","ext.visualEditor.desktopArticleTarget.init","ext.visualEditor.targetLoader","ext.eventLogging","ext.wikimediaEvents","ext.navigationTiming","ext.uls.eventlogger","ext.uls.init","ext.uls.compactlinks","ext.uls.interface","ext.centralNotice.geoIP","ext.centralNotice.startUp","ext.flaggedRevs.advanced","skins.vector.js"];mw.loader.load(RLPAGEMODULES);});</script>
<link rel="stylesheet" href="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/load.php">
<script async="" src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/load(1).php"></script>
<style>
.mw-editfont-monospace{font-family:monospace,monospace}.mw-editfont-sans-serif{font-family:sans-serif}.mw-editfont-serif{font-family:serif} .mw-editfont-monospace,.mw-editfont-sans-serif,.mw-editfont-serif{font-size:13px; }.mw-editfont-monospace.oo-ui-textInputWidget,.mw-editfont-sans-serif.oo-ui-textInputWidget,.mw-editfont-serif.oo-ui-textInputWidget{font-size:inherit}.mw-editfont-monospace > .oo-ui-inputWidget-input,.mw-editfont-sans-serif > .oo-ui-inputWidget-input,.mw-editfont-serif > .oo-ui-inputWidget-input{font-size:13px}
.mw-ui-button{background-color:#f8f9fa;color:#222222;display:inline-block;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;min-width:4em;max-width:28.75em;margin:0;padding:0.57142857em 0.9375em;border:1px solid #a2a9b1;border-radius:2px;font-family:inherit;font-size:1em;font-weight:bold;line-height:1;text-align:center;-webkit-appearance:none;*display:inline; zoom:1;vertical-align:middle;cursor:pointer}.mw-ui-button:visited{color:#222222}.mw-ui-button:hover{background-color:#ffffff;color:#444444;border-color:#a2a9b1}.mw-ui-button:focus{background-color:#ffffff;color:#222222;border-color:#3366cc;box-shadow:inset 0 0 0 1px #3366cc,inset 0 0 0 2px #ffffff;outline-width:0}.mw-ui-button:focus::-moz-focus-inner{border-color:transparent;padding:0}.mw-ui-button:active,.mw-ui-button.is-on{background-color:#c8ccd1;color:#000000;border-color:#72777d;box-shadow:none}.mw-ui-button:disabled{background-color:#c8ccd1;color:#ffffff;border-color:#c8ccd1;cursor:default}.mw-ui-button:disabled:hover,.mw-ui-button:disabled:active{background-color:#c8ccd1;color:#ffffff;box-shadow:none;border-color:#c8ccd1}.mw-ui-button:not(:disabled){-webkit-transition:background-color 100ms,color 100ms,border-color 100ms,box-shadow 100ms;-moz-transition:background-color 100ms,color 100ms,border-color 100ms,box-shadow 100ms;transition:background-color 100ms,color 100ms,border-color 100ms,box-shadow 100ms}.mw-ui-button.mw-ui-quiet,.mw-ui-button.mw-ui-quiet.mw-ui-progressive,.mw-ui-button.mw-ui-quiet.mw-ui-destructive{background-color:transparent;color:#222222;border-color:transparent}.mw-ui-button.mw-ui-quiet:hover,.mw-ui-button.mw-ui-quiet.mw-ui-progressive:hover,.mw-ui-button.mw-ui-quiet.mw-ui-destructive:hover{background-color:transparent;color:#444444;border-color:transparent;box-shadow:none}.mw-ui-button.mw-ui-quiet:active,.mw-ui-button.mw-ui-quiet.mw-ui-progressive:active,.mw-ui-button.mw-ui-quiet.mw-ui-destructive:active{background-color:transparent;color:#000000;border-color:transparent}.mw-ui-button.mw-ui-quiet:focus,.mw-ui-button.mw-ui-quiet.mw-ui-progressive:focus,.mw-ui-button.mw-ui-quiet.mw-ui-destructive:focus{background-color:transparent;color:#222222;border-color:transparent;box-shadow:none}.mw-ui-button.mw-ui-quiet:disabled,.mw-ui-button.mw-ui-quiet.mw-ui-progressive:disabled,.mw-ui-button.mw-ui-quiet.mw-ui-destructive:disabled,.mw-ui-button.mw-ui-quiet:disabled:hover,.mw-ui-button.mw-ui-quiet.mw-ui-progressive:disabled:hover,.mw-ui-button.mw-ui-quiet.mw-ui-destructive:disabled:hover,.mw-ui-button.mw-ui-quiet:disabled:active,.mw-ui-button.mw-ui-quiet.mw-ui-progressive:disabled:active,.mw-ui-button.mw-ui-quiet.mw-ui-destructive:disabled:active{background-color:transparent;color:#72777d;border-color:transparent}.mw-ui-button.mw-ui-progressive{background-color:#3366cc;color:#fff;border:1px solid #3366cc}.mw-ui-button.mw-ui-progressive:hover{background-color:#447ff5;border-color:#447ff5}.mw-ui-button.mw-ui-progressive:focus{box-shadow:inset 0 0 0 1px #3366cc,inset 0 0 0 2px #ffffff}.mw-ui-button.mw-ui-progressive:active,.mw-ui-button.mw-ui-progressive.is-on{background-color:#2a4b8d;border-color:#2a4b8d;box-shadow:none}.mw-ui-button.mw-ui-progressive:disabled{background-color:#c8ccd1;color:#fff;border-color:#c8ccd1}.mw-ui-button.mw-ui-progressive:disabled:hover,.mw-ui-button.mw-ui-progressive:disabled:active{background-color:#c8ccd1;color:#fff;border-color:#c8ccd1;box-shadow:none}.mw-ui-button.mw-ui-progressive.mw-ui-quiet{color:#3366cc}.mw-ui-button.mw-ui-progressive.mw-ui-quiet:hover{background-color:transparent;color:#447ff5}.mw-ui-button.mw-ui-progressive.mw-ui-quiet:active{color:#2a4b8d}.mw-ui-button.mw-ui-progressive.mw-ui-quiet:focus{background-color:transparent;color:#3366cc}.mw-ui-button.mw-ui-destructive{background-color:#dd3333;color:#fff;border:1px solid #dd3333}.mw-ui-button.mw-ui-destructive:hover{background-color:#ff4242;border-color:#ff4242}.mw-ui-button.mw-ui-destructive:focus{box-shadow:inset 0 0 0 1px #dd3333,inset 0 0 0 2px #ffffff}.mw-ui-button.mw-ui-destructive:active,.mw-ui-button.mw-ui-destructive.is-on{background-color:#b32424;border-color:#b32424;box-shadow:none}.mw-ui-button.mw-ui-destructive:disabled{background-color:#c8ccd1;color:#fff;border-color:#c8ccd1}.mw-ui-button.mw-ui-destructive:disabled:hover,.mw-ui-button.mw-ui-destructive:disabled:active{background-color:#c8ccd1;color:#fff;border-color:#c8ccd1;box-shadow:none}.mw-ui-button.mw-ui-destructive.mw-ui-quiet{color:#dd3333}.mw-ui-button.mw-ui-destructive.mw-ui-quiet:hover{background-color:transparent;color:#ff4242}.mw-ui-button.mw-ui-destructive.mw-ui-quiet:active{color:#b32424}.mw-ui-button.mw-ui-destructive.mw-ui-quiet:focus{background-color:transparent;color:#dd3333}.mw-ui-button.mw-ui-big{font-size:1.3em}.mw-ui-button.mw-ui-block{display:block;width:100%;margin-left:auto;margin-right:auto}input.mw-ui-button::-moz-focus-inner,button.mw-ui-button::-moz-focus-inner{margin-top:-1px;margin-bottom:-1px}a.mw-ui-button{text-decoration:none}a.mw-ui-button:hover,a.mw-ui-button:focus{text-decoration:none}.mw-ui-button-group > *{min-width:48px;border-radius:0;float:left}.mw-ui-button-group > *:first-child{border-top-left-radius:2px;border-bottom-left-radius:2px}.mw-ui-button-group > *:not(:first-child){border-left:0}.mw-ui-button-group > *:last-child{border-top-right-radius:2px;border-bottom-right-radius:2px}.mw-ui-button-group .is-on .button{cursor:default}
.mw-ui-icon{position:relative;line-height:1.5em;min-height:1.5em;min-width:1.5em}span.mw-ui-icon{display:inline-block}.mw-ui-icon.mw-ui-icon-element{text-indent:-999px;overflow:hidden;width:3.5em;min-width:3.5em;max-width:3.5em}.mw-ui-icon.mw-ui-icon-element:before{left:0;right:0;position:absolute;margin:0 1em}.mw-ui-icon.mw-ui-icon-element.mw-ui-icon-large{width:4.625em;min-width:4.625em;max-width:4.625em;line-height:4.625em;min-height:4.625em}.mw-ui-icon.mw-ui-icon-element.mw-ui-icon-large:before{min-height:4.625em}.mw-ui-icon.mw-ui-icon-before:before,.mw-ui-icon.mw-ui-icon-element:before{background-position:50% 50%;background-repeat:no-repeat;background-size:100% auto;float:left;display:block;min-height:1.5em;content:''}.mw-ui-icon.mw-ui-icon-before:before{position:relative;width:1.5em;margin-right:1em}.mw-ui-icon.mw-ui-icon-small:before{background-size:66.67% auto}
.ve-init-mw-progressBarWidget{height:1em;overflow:hidden;margin:0 25%}.ve-init-mw-progressBarWidget-bar{height:1em;width:0} .ve-init-mw-progressBarWidget{height:0.75em;border:1px solid #36c;background:#fff;border-radius:2px;box-shadow:0 0.1em 0 0 rgba(0,0,0,0.15)}.ve-init-mw-progressBarWidget-bar{height:0.75em;background:#36c}
.suggestions{overflow:hidden;position:absolute;top:0;left:0;width:0;border:0;z-index:1099;padding:0;margin:-1px 0 0 0}.suggestions-special{position:relative;background-color:#fff;cursor:pointer;border:1px solid #a2a9b1;margin:0;margin-top:-2px;display:none;padding:0.25em 0.25em;line-height:1.25em}.suggestions-results{background-color:#fff;cursor:pointer;border:1px solid #a2a9b1;padding:0;margin:0}.suggestions-result{color:#000;margin:0;line-height:1.5em;padding:0.01em 0.25em;text-align:left; overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.suggestions-result-current{background-color:#2a4b8d;color:#fff}.suggestions-special .special-label{color:#72777d;text-align:left}.suggestions-special .special-query{color:#000;font-style:italic;text-align:left}.suggestions-special .special-hover{background-color:#c8ccd1}.suggestions-result-current .special-label,.suggestions-result-current .special-query{color:#fff}.highlight{font-weight:bold}
@media screen {
	.tochidden,.toctoggle{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.toctoggle{font-size:94%}}
@media print {
	.toc.tochidden,.toctoggle{display:none}}
@-webkit-keyframes centralAuthPPersonalAnimation{0%{opacity:0;-webkit-transform:translateY(-20px)}100%{opacity:1;-webkit-transform:translateY(0)}}@-moz-keyframes centralAuthPPersonalAnimation{0%{opacity:0;-moz-transform:translateY(-20px)}100%{opacity:1;-moz-transform:translateY(0)}}@-o-keyframes centralAuthPPersonalAnimation{0%{opacity:0;-o-transform:translateY(-20px)}100%{opacity:1;-o-transform:translateY(0)}}@keyframes centralAuthPPersonalAnimation{0%{opacity:0;transform:translateY(-20px)}100%{opacity:1;transform:translateY(0)}}.centralAuthPPersonalAnimation{-webkit-animation-duration:1s;-moz-animation-duration:1s;-o-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;-moz-animation-fill-mode:both;-o-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:centralAuthPPersonalAnimation;-moz-animation-name:centralAuthPPersonalAnimation;-o-animation-name:centralAuthPPersonalAnimation;animation-name:centralAuthPPersonalAnimation}
@media print{#centralNotice{display:none}}.cn-closeButton{display:inline-block;zoom:1;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUBAMAAAB/pwA+AAAAElBMVEUAAAAQEBDPz88AAABAQEDv7+9oe1vvAAAABnRSTlMA3rLe3rJS22KzAAAARElEQVQI12PAAUIUQCSTK5BwFgIxFU1AhKECUFAYKAAioXwwBeZChMGCEGGQIFQYJohgIhQgtCEMQ7ECYTHCOciOxA4AADgJTXIb9s8AAAAASUVORK5CYII=) no-repeat;background:url(/w/extensions/CentralNotice/resources/subscribing/close.png?8e3d8) no-repeat!ie;width:20px;height:20px;text-indent:20px;white-space:nowrap;overflow:hidden}
.uls-menu{border-radius:2px; font-size:medium}.uls-search,.uls-language-settings-close-block{border-top-right-radius:2px;border-top-left-radius:2px}.uls-language-list{border-bottom-right-radius:2px;border-bottom-left-radius:2px}.uls-menu.callout:before,.uls-menu.callout:after{border-top:10px solid transparent;border-bottom:10px solid transparent;display:inline-block; top:17px;position:absolute;content:''}.uls-menu.callout.selector-right:before{ border-left:10px solid #c8ccd1; right:-11px}.uls-menu.callout.selector-right:after{ border-left:10px solid #fff; right:-10px}.uls-menu.callout.selector-left:before{ border-right:10px solid #c8ccd1; left:-11px}.uls-menu.callout.selector-left:after{ border-right:10px solid #fff; left:-10px}.uls-ui-languages button{margin:5px 15px 5px 0;white-space:nowrap;overflow:hidden}.uls-search-wrapper-wrapper{position:relative;padding-left:40px;margin-top:5px;margin-bottom:5px}.uls-icon-back{background:transparent url(/w/extensions/UniversalLanguageSelector/resources/images/back-grey-ltr.png?90e9b) no-repeat scroll center center;background-image:-webkit-linear-gradient(transparent,transparent),url(/w/extensions/UniversalLanguageSelector/resources/images/back-grey-ltr.svg?e226b);background-image:linear-gradient(transparent,transparent),url("data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2224%22 height=%2224%22 viewBox=%220 0 24 24%22%3E %3Cpath fill=%22%2354595d%22 d=%22M7 13.1l8.9 8.9c.8-.8.8-2 0-2.8l-6.1-6.1 6-6.1c.8-.8.8-2 0-2.8L7 13.1z%22/%3E %3C/svg%3E");background-size:28px;background-position:center center;height:32px;width:40px;display:block;position:absolute;left:0;border-right:1px solid #c8ccd1;opacity:0.8}.uls-icon-back:hover{opacity:1;cursor:pointer}.uls-menu .uls-no-results-view .uls-no-found-more{background-color:#fff}.uls-menu .uls-no-results-view h3{padding:0 28px;margin:0;color:#54595d;font-size:1em;font-weight:normal}  .skin-vector .uls-menu{border-color:#c8ccd1;-webkit-box-shadow:0 2px 2px 0 rgba(0,0,0,0.25);box-shadow:0 2px 2px 0 rgba(0,0,0,0.25);font-size:0.875em}.skin-vector .uls-search{border-bottom-color:#c8ccd1}.skin-vector .uls-filtersuggestion{color:#72777d}.skin-vector .uls-lcd-region-title{color:#54595d}</style><style>
.suggestions a.mw-searchSuggest-link,.suggestions a.mw-searchSuggest-link:hover,.suggestions a.mw-searchSuggest-link:active,.suggestions a.mw-searchSuggest-link:focus{color:#000;text-decoration:none}.suggestions-result-current a.mw-searchSuggest-link,.suggestions-result-current a.mw-searchSuggest-link:hover,.suggestions-result-current a.mw-searchSuggest-link:active,.suggestions-result-current a.mw-searchSuggest-link:focus{color:#fff}.suggestions a.mw-searchSuggest-link .special-query{ overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.mw-mmv-overlay{position:fixed;top:0;left:0;right:0;bottom:0;z-index:1000;background-color:#000}body.mw-mmv-lightbox-open{overflow-y:auto;  }body.mw-mmv-lightbox-open #mw-page-base,body.mw-mmv-lightbox-open #mw-head-base,body.mw-mmv-lightbox-open #mw-navigation,body.mw-mmv-lightbox-open #content,body.mw-mmv-lightbox-open #footer,body.mw-mmv-lightbox-open #globalWrapper{ display:none}body.mw-mmv-lightbox-open > *{ display:none}body.mw-mmv-lightbox-open > .mw-mmv-overlay,body.mw-mmv-lightbox-open > .mw-mmv-wrapper{display:block}.mw-mmv-filepage-buttons{margin-top:5px}.mw-mmv-filepage-buttons .mw-mmv-view-expanded,.mw-mmv-filepage-buttons .mw-mmv-view-config{display:block;line-height:inherit}.mw-mmv-filepage-buttons .mw-mmv-view-expanded.mw-ui-icon:before{background-image:url("data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 1024 768%22%3E %3Cpath d=%22M851.2 71.6L690.7 232.1l-40.1-40.3-9.6 164.8 164.8-9.3-40.3-40.4L926 146.4l58.5 58.5L997.6 0 792.7 13.1%22/%3E %3Cpath d=%22M769.6 89.3H611.9l70.9 70.8 7.9 7.5m-47.1 234.6l-51.2 3 3-51.2 9.4-164.4 5.8-100.3H26.4V768h883.1V387l-100.9 5.8-165 9.4zM813.9 678H113.6l207.2-270.2 31.5-12.9L548 599.8l105.9-63.2 159.8 140.8.2.6zm95.6-291.9V228l-79.1 78.9 7.8 7.9%22/%3E %3C/svg%3E")}.mw-mmv-filepage-buttons .mw-mmv-view-config.mw-ui-icon:before{background-image:url("data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 1024 768%22%3E %3Cpath d=%22M897 454.6V313.4L810.4 299c-6.4-23.3-16-45.7-27.3-65.8l50.5-71.4-99.4-100.2-71.4 50.5c-20.9-11.2-42.5-20.9-65.8-27.3L582.6-1H441.4L427 85.6c-23.3 6.4-45.7 16-65.8 27.3l-71.4-50.5-100.3 99.5 50.5 71.4c-11.2 20.9-20.9 42.5-27.3 66.6L127 313.4v141.2l85.8 14.4c6.4 23.3 16 45.7 27.3 66.6L189.6 607l99.5 99.5 71.4-50.5c20.9 11.2 42.5 20.9 66.6 27.3l14.4 85.8h141.2l14.4-86.6c23.3-6.4 45.7-16 65.8-27.3l71.4 50.5 99.5-99.5-50.5-71.4c11.2-20.9 20.9-42.5 27.3-66.6l86.4-13.6zm-385 77c-81.8 0-147.6-66.6-147.6-147.6 0-81.8 66.6-147.6 147.6-147.6S659.6 302.2 659.6 384 593.8 531.6 512 531.6z%22/%3E %3C/svg%3E");opacity:0.75}.mw-mmv-filepage-buttons .mw-mmv-view-config.mw-ui-icon:before:hover{opacity:1}.mw-mmv-button{background-color:transparent;min-width:0;border:0;padding:0;overflow-x:hidden;text-indent:-9999em}
.ve-init-mw-tempWikitextEditorWidget{border:0;padding:0;color:inherit;line-height:1.5em;width:100%; }.ve-init-mw-tempWikitextEditorWidget:focus{outline:0;padding:0}.ve-init-mw-tempWikitextEditorWidget::selection{background:rgba(109,169,247,0.5); }
#p-lang .body ul .uls-trigger,#p-lang .pBody ul .uls-trigger{background-image:none;padding:0} .mw-interlanguage-selector,.mw-interlanguage-selector:active{cursor:pointer;padding:4px 6px 4px 25px;font-size:13px;font-weight:normal;background-image:url(/w/extensions/UniversalLanguageSelector/resources/images/compact-links-trigger.png?b0c8e);background-image:linear-gradient(transparent,transparent),url("data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2218%22 height=%2218%22 viewBox=%220 0 24 24%22%3E %3Cpath fill=%22%2372777d%22 d=%22M13 19l.8-3h5.3l.9 3h2.2L18 6h-3l-4.2 13H13zm3.5-11l2 6h-4l2-6zM5 4l.938 1.906H1V8h1.594C3.194 9.8 4 11.206 5 12.406c-1.1.7-4.313 1.781-4.313 1.781L2 16s3.487-1.387 4.688-2.188c1 .7 2.319 1.188 3.719 1.688l.594-2c-1-.3-1.988-.688-2.688-1.188 1.1-1.1 1.9-2.506 2.5-4.406h2.188l.5-2H7.938L7 4H5zm-.188 4h3.781c-.4 1.3-.906 2-1.906 3-1.1-1-1.475-1.7-1.875-3z%22/%3E %3C/svg%3E");background-size:18px;background-repeat:no-repeat;background-position:left 4px center;margin:4px 0;text-align:left}.mw-interlanguage-selector:active,.mw-interlanguage-selector.selector-open{background-color:#c8ccd1;color:#54595d}.interlanguage-uls-menu:before,.interlanguage-uls-menu:after{border-top:10px solid transparent;border-bottom:10px solid transparent;display:inline-block; top:17px;position:absolute;content:''}.interlanguage-uls-menu.selector-right:before{ border-left:10px solid #c8ccd1; right:-11px}.interlanguage-uls-menu.selector-right:after{ border-left:10px solid #fff; right:-10px}.interlanguage-uls-menu.selector-left:before{ border-right:10px solid #c8ccd1; left:-11px}.interlanguage-uls-menu.selector-left:after{ border-right:10px solid #fff; left:-10px}
#uls-settings-block{background-color:#f8f9fa;border-top:1px solid #c8ccd1;padding-left:10px;line-height:1.2em;border-radius:0 0 2px 2px}#uls-settings-block > button{background:left top transparent no-repeat;background-size:20px auto;color:#54595d;display:inline-block;margin:8px 15px;border:0;padding:0 0 0 26px;font-size:medium;cursor:pointer}#uls-settings-block > button:hover{color:#222}#uls-settings-block > button.display-settings-block{background-image:url(/w/extensions/UniversalLanguageSelector/resources/images/display.png?d25f1);background-image:linear-gradient(transparent,transparent),url("data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2220%22 height=%2220%22 viewBox=%220 0 20 20%22%3E %3Cpath fill=%22%23222%22 d=%22M.002 2.275V15.22h8.405c.535 1.624-.975 1.786-1.902 2.505 0 0 2.293-.024 3.439-.024 1.144 0 3.432.024 3.432.024-.905-.688-2.355-.868-1.902-2.505h8.527V2.275h-20zm6.81 1.84h.797l3.313 8.466H9.879L8.836 9.943H5.462l-1.043 2.638h-.982zm.368 1.104c-.084.369-.211.785-.368 1.227L5.83 9.023h2.699l-.982-2.577c-.128-.33-.234-.747-.368-1.227zm7.117.982c.753 0 1.295.157 1.656.491.365.334.552.858.552 1.595v4.294h-.675l-.184-.859h-.062c-.315.396-.605.655-.92.798-.311.138-.758.184-1.227.184-.626 0-1.115-.168-1.472-.491-.353-.323-.491-.754-.491-1.35 0-1.275 1.028-1.963 3.068-2.025h1.043v-.429c0-.495-.091-.87-.307-1.104-.211-.238-.574-.307-1.043-.307-.526 0-1.115.107-1.779.429l-.307-.675a4.748 4.748 0 0 1 1.043-.429 4.334 4.334 0 0 1 1.104-.123zm.307 3.313c-.761.027-1.318.157-1.656.368-.334.207-.491.54-.491.982 0 .346.1.617.307.798.211.181.544.245.92.245.595 0 1.012-.164 1.35-.491.342-.326.552-.762.552-1.35v-.552z%22/%3E %3C/svg%3E")}#uls-settings-block > button.input-settings-block{background-image:url(/w/extensions/UniversalLanguageSelector/resources/images/input.png?aea9e);background-image:linear-gradient(transparent,transparent),url("data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2220%22 height=%2220%22 viewBox=%220 0 20 20%22%3E %3Cpath fill=%22%23222%22 d=%22M9 1.281c-.124.259-.185.599-.5.688-.55.081-1.133.018-1.688 0-.866-.032-1.733-.148-2.594 0-.588.157-.953.727-1.188 1.25-.178.416-.271.836-.344 1.281H-.002V16h20V4.5H3.654c.109-.52.203-1.057.563-1.469.222-.231.587-.17.875-.188 1.212.003 2.415.179 3.625.063.463-.058.812-.455.969-.875l.188-.438-.875-.313zM1.875 7.125h1.563c.094 0 .188.093.188.188v1.531a.201.201 0 0 1-.188.188H1.875c-.094 0-.156-.093-.156-.188V7.313c0-.094.062-.188.156-.188zm2.844 0h1.563c.094 0 .156.093.156.188v1.531c0 .094-.062.188-.156.188H4.719c-.094 0-.156-.093-.156-.188V7.313c0-.094.062-.188.156-.188zm2.844 0h1.563c.094 0 .156.093.156.188v1.531c0 .094-.062.188-.156.188H7.563a.201.201 0 0 1-.188-.188V7.313c0-.094.093-.188.188-.188zm2.813 0h1.563c.094 0 .188.093.188.188v1.531a.201.201 0 0 1-.188.188h-1.563c-.094 0-.156-.093-.156-.188V7.313c0-.094.062-.188.156-.188zm2.844 0h1.563c.094 0 .156.093.156.188v1.531c0 .094-.062.188-.156.188H13.22c-.094 0-.156-.093-.156-.188V7.313c0-.094.062-.188.156-.188zm2.844 0h1.531c.094 0 .188.093.188.188v1.531a.201.201 0 0 1-.188.188h-1.531a.201.201 0 0 1-.188-.188V7.313c0-.094.093-.188.188-.188zm-12.844 3h1.563c.094 0 .156.093.156.188v1.563c0 .094-.062.156-.156.156H3.22c-.094 0-.156-.062-.156-.156v-1.563c0-.094.062-.188.156-.188zm2.906 0h1.563c.094 0 .188.093.188.188v1.563c0 .094-.093.156-.188.156H6.126c-.094 0-.156-.062-.156-.156v-1.563c0-.094.062-.188.156-.188zm2.938 0h1.531c.094 0 .188.093.188.188v1.563c0 .094-.093.156-.188.156H9.064c-.094 0-.188-.062-.188-.156v-1.563c0-.094.093-.188.188-.188zm2.906 0h1.563c.094 0 .156.093.156.188v1.563c0 .094-.062.156-.156.156H11.97c-.094 0-.188-.062-.188-.156v-1.563c0-.094.093-.188.188-.188zm2.906 0h1.563c.094 0 .156.093.156.188v1.563c0 .094-.062.156-.156.156h-1.563c-.094 0-.156-.062-.156-.156v-1.563c0-.094.062-.188.156-.188zM4.001 13.688h12c.088 0 .156.068.156.156v.844a.154.154 0 0 1-.156.156h-12a.154.154 0 0 1-.156-.156v-.844c0-.088.068-.156.156-.156z%22/%3E %3C/svg%3E")}</style><style>
.ve-activated .ve-init-mw-desktopArticleTarget-editableContent #toc,.ve-activated #siteNotice,.ve-activated .mw-indicators,.ve-activated #t-print,.ve-activated #t-permalink,.ve-activated #p-coll-print_export,.ve-activated #t-cite,.ve-deactivating .ve-ui-surface,.ve-active .ve-init-mw-desktopArticleTarget-editableContent,.ve-active .ve-init-mw-tempWikitextEditorWidget{display:none} .ve-activating .ve-ui-surface{height:0;padding:0 !important; overflow:hidden} .ve-loading #content > :not(.ve-init-mw-desktopArticleTarget-loading-overlay), .ve-activated .ve-init-mw-desktopArticleTarget-uneditableContent{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.5}.ve-activated #firstHeading{ -webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.ve-activated #catlinks{cursor:pointer}.ve-activated #catlinks a{opacity:1}.ve-activated #content{position:relative} .ve-init-mw-desktopArticleTarget-loading-overlay{position:absolute;top:1.25em;left:0;right:0;z-index:1;margin-top:-0.5em}.ve-init-mw-desktopArticleTarget-toolbarPlaceholder{transition:height 250ms ease;height:0; } .oo-ui-element-hidden{display:none !important; } .mw-editsection{white-space:nowrap; unicode-bidi:-moz-isolate;unicode-bidi:-webkit-isolate;unicode-bidi:isolate}.mw-editsection-divider{color:#54595d} .ve-init-mw-desktopArticleTarget-toolbarPlaceholder{border-bottom:1px solid #c8ccd1;box-shadow:0 1px 1px 0 rgba(0,0,0,0.1)}.ve-init-mw-desktopArticleTarget-toolbarPlaceholder-open{height:42px} .ve-init-mw-desktopArticleTarget-toolbar,.ve-init-mw-desktopArticleTarget-toolbarPlaceholder{font-size:0.875em; margin:-1.14em -1.14em 1.14em -1.14em; }@media screen and (min-width:982px){.ve-init-mw-desktopArticleTarget-toolbar,.ve-init-mw-desktopArticleTarget-toolbarPlaceholder{ margin:-1.43em -1.71em 1.43em -1.71em}}</style><meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/load(2).php">
<meta name="generator" content="MediaWiki 1.33.0-wmf.21">
<meta name="referrer" content="origin">
<meta name="referrer" content="origin-when-crossorigin">
<meta name="referrer" content="origin-when-cross-origin">
<link rel="alternate" type="application/x-wiki" title="Edit" href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit">
<link rel="edit" title="Edit" href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit">
<link rel="shortcut icon" href="https://en.wikibooks.org/static/favicon/wikibooks.ico">
<link rel="search" type="application/opensearchdescription+xml" href="https://en.wikibooks.org/w/opensearch_desc.php" title="Wikibooks (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://en.wikibooks.org/w/api.php?action=rsd">
<link rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/">
<link rel="alternate" type="application/atom+xml" title="Wikibooks Atom feed" href="https://en.wikibooks.org/w/index.php?title=Special:RecentChanges&amp;feed=atom">
<link rel="canonical" href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain">
<link rel="dns-prefetch" href="https://login.wikimedia.org/">
<link rel="dns-prefetch" href="https://meta.wikimedia.org/">
<!--[if lt IE 9]><script src="/w/load.php?lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=vector&amp;sync=1"></script><![endif]-->
<script src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/index.php"></script><script src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/index(1).php"></script><script src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/index(2).php"></script><script src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/index(3).php"></script><script src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/index(4).php"></script><script src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/index(5).php"></script><script src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/index(6).php"></script><script src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/index(7).php"></script><script src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/index(8).php"></script><script src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/index(9).php"></script><script src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/index(10).php"></script><script src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/index(11).php"></script><script src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/index(12).php"></script><link rel="stylesheet" href="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/index(13).php"><script src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/index(14).php"></script></head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject mw-editable page-Algorithm_Implementation_Geometry_Convex_hull_Monotone_chain rootpage-Algorithm_Implementation skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="siteNotice" class="mw-body-content"><div id="centralNotice"></div><!-- CentralNotice --></div><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">Algorithm Implementation/Geometry/Convex hull/Monotone chain</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From Wikibooks, open books for an open world</div>				<div id="contentSub"><span class="subpages">&lt; <a href="https://en.wikibooks.org/wiki/Algorithm_Implementation" title="Algorithm Implementation">Algorithm Implementation</a>‎&nbsp;| <a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry" title="Algorithm Implementation/Geometry">Geometry</a>‎&nbsp;| <a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull" title="Algorithm Implementation/Geometry/Convex hull">Convex hull</a></span></div>
				<div id="jump-to-nav"></div>				<a class="mw-jump-link" href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#mw-head">Jump to navigation</a>
				<a class="mw-jump-link" href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#p-search">Jump to search</a>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:Animation_depicting_the_Monotone_algorithm.gif" class="image"><img alt="" src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/Animation_depicting_the_Monotone_algorithm.gif" decoding="async" width="220" height="220" class="thumbimage" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Animation_depicting_the_Monotone_algorithm.gif/330px-Animation_depicting_the_Monotone_algorithm.gif 1.5x, //upload.wikimedia.org/wikipedia/commons/9/9a/Animation_depicting_the_Monotone_algorithm.gif 2x" data-file-width="400" data-file-height="400"></a>  <div class="thumbcaption"><div class="magnify"><a href="https://en.wikibooks.org/wiki/File:Animation_depicting_the_Monotone_algorithm.gif" class="internal" title="Enlarge"></a></div>Animation depicting the Monotone convex hull algorithm</div></div></div>
<p><b>Andrew's monotone chain convex hull algorithm</b> constructs the <a href="https://en.wikipedia.org/wiki/Convex_Hull" class="extiw" title="w:Convex Hull">convex hull</a> of
a set of 2-dimensional points in <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="{\displaystyle O(n\log n)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>O</mi>
        <mo stretchy="false">(</mo>
        <mi>n</mi>
        <mi>log</mi>
        <mo>⁡<!-- ⁡ --></mo>
        <mi>n</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle O(n\log n)}</annotation>
  </semantics>
</math></span><img src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/9d2320768fb54880ca4356e61f60eb02a3f9d9f1" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:10.118ex; height:2.843ex;" alt="O(n\log n)"></span> time.
</p><p>It does so by first sorting the points lexicographically (first by <i>x</i>-coordinate, and in case of a tie, by <i>y</i>-coordinate), and then constructing upper and lower hulls of the points in <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="{\displaystyle O(n)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>O</mi>
        <mo stretchy="false">(</mo>
        <mi>n</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle O(n)}</annotation>
  </semantics>
</math></span><img src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/34109fe397fdcff370079185bfdb65826cb5565a" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; width:4.977ex; height:2.843ex;" alt="O(n)"></span> time.
</p><p>An upper hull is the part of the convex hull, which is visible from the above. It runs from its rightmost point to the leftmost point in counterclockwise order. Lower hull is the remaining part of the convex hull.
</p>
<div class="thumb tright"><div class="thumbinner" style="width:222px;"><a href="https://commons.wikimedia.org/wiki/File:UpperAndLowerConvexHulls.png" class="image"><img alt="" src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/220px-UpperAndLowerConvexHulls.png" decoding="async" width="220" height="175" class="thumbimage" srcset="//upload.wikimedia.org/wikipedia/commons/d/d5/UpperAndLowerConvexHulls.png 1.5x" data-file-width="260" data-file-height="207"></a>  <div class="thumbcaption"><div class="magnify"><a href="https://en.wikibooks.org/wiki/File:UpperAndLowerConvexHulls.png" class="internal" title="Enlarge"></a></div>Upper and lowers hulls of a set of points</div></div></div>
<div id="toc" class="toc"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#Pseudo-code"><span class="tocnumber">1</span> <span class="toctext">Pseudo-code</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#Fortran"><span class="tocnumber">2</span> <span class="toctext">Fortran</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#JavaScript"><span class="tocnumber">3</span> <span class="toctext">JavaScript</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#Java"><span class="tocnumber">4</span> <span class="toctext">Java</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#Python"><span class="tocnumber">5</span> <span class="toctext">Python</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#Ruby"><span class="tocnumber">6</span> <span class="toctext">Ruby</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#C++"><span class="tocnumber">7</span> <span class="toctext">C++</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#Perl"><span class="tocnumber">8</span> <span class="toctext">Perl</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#C"><span class="tocnumber">9</span> <span class="toctext">C</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#Haskell"><span class="tocnumber">10</span> <span class="toctext">Haskell</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#Elixir"><span class="tocnumber">11</span> <span class="toctext">Elixir</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#Clojure"><span class="tocnumber">12</span> <span class="toctext">Clojure</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#Scala"><span class="tocnumber">13</span> <span class="toctext">Scala</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#PHP"><span class="tocnumber">14</span> <span class="toctext">PHP</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#Swift"><span class="tocnumber">15</span> <span class="toctext">Swift</span></a></li>
<li class="toclevel-1 tocsection-16"><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#References"><span class="tocnumber">16</span> <span class="toctext">References</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Pseudo-code">Pseudo-code</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=1" title="Edit section: Pseudo-code">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre>
Input: a list P of points in the plane.

Precondition: There must be at least 3 points.

Sort the points of P by x-coordinate (in case of a tie, sort by y-coordinate).

Initialize U and L as empty lists.
The lists will hold the vertices of upper and lower hulls respectively.

for i = 1, 2, ..., n:
    while L contains at least two points and the sequence of last two points
            of L and the point P[i] does not make a counter-clockwise turn:
        remove the last point from L
    append P[i] to L

for i = n, n-1, ..., 1:
    while U contains at least two points and the sequence of last two points
            of U and the point P[i] does not make a counter-clockwise turn:
        remove the last point from U
    append P[i] to U

Remove the last point of each list (it's the same as the first point of the other list).
Concatenate L and U to obtain the convex hull of P.
Points in the result will be listed in counter-clockwise order.
</pre>
<h2><span class="mw-headline" id="Fortran">Fortran</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=2" title="Edit section: Fortran">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Note that this implementation works on sorted input points. The algorithm is array based.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">FUNCTION </span><span class="n">Cross</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">)</span>
<span class="c">! IMPLICIT VARIABLE HANDLING</span>
<span class="k">IMPLICIT NONE</span>
<span class="c">!-----------------------------------------------</span>
<span class="c">! INPUT VARIABLES</span>
<span class="kt">REAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">v1</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>    <span class="c">!&lt; input vector 1</span>
<span class="kt">REAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">v2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>    <span class="c">!&lt; input vector 2</span>
<span class="kt">REAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">v3</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>    <span class="c">!&lt; input vector 3</span>
<span class="c">!-----------------------------------------------</span>
<span class="c">! OUTPUT VARIABLES</span>
<span class="kt">REAL</span>            <span class="kd">::</span> <span class="n">Cross</span>    <span class="c">!&lt; cross product</span>
<span class="c">!-----------------------------------------------</span>
<span class="c">! LOCAL VARIABLES</span>
<span class="c">!===============================================</span>
<span class="n">Cross</span><span class="o">=</span><span class="p">(</span><span class="n">v2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">v1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">v3</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">v1</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="n">v2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">v1</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">v3</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">v1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="k">END FUNCTION </span><span class="n">Cross</span>

<span class="k">SUBROUTINE </span><span class="n">ConvHull</span><span class="p">(</span><span class="n">nPoints</span><span class="p">,</span><span class="n">Points</span><span class="p">,</span><span class="n">nHull</span><span class="p">,</span><span class="n">Hull</span><span class="p">)</span>
<span class="c">! IMPLICIT VARIABLE HANDLING</span>
<span class="k">IMPLICIT NONE</span> 
<span class="c">!------------------------------------------------</span>
<span class="c">! INPUT VARIABLES</span>
<span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">nPoints</span>
<span class="kt">REAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">Points</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">nPoints</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="c">!------------------------------------------------</span>
<span class="c">! OUTPUT VARIABLES</span>
<span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nHull</span>
<span class="c">! NOTE: allocate Hull always one point greater than Points, because we save the first value twice</span>
<span class="kt">REAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Hull</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">nPoints</span><span class="p">)</span>
<span class="c">!------------------------------------------------</span>
<span class="c">! LOCAL VARIABLES</span>
<span class="kt">REAL</span>                <span class="kd">::</span> <span class="n">Lower</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">nPoints</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="kt">REAL</span>                <span class="kd">::</span> <span class="n">Upper</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">nPoints</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">iLower</span><span class="p">,</span><span class="n">iUpper</span>
<span class="c">!================================================</span>
<span class="k">IF</span><span class="p">(</span><span class="n">nPoints</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<span class="k">  </span><span class="n">Hull</span>  <span class="o">=</span> <span class="n">Points</span>
  <span class="n">nHull</span> <span class="o">=</span> <span class="n">nPoints</span>
<span class="k">ELSE</span>
<span class="k">  </span><span class="n">iLower</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">Lower</span>  <span class="o">=</span> <span class="o">-</span><span class="nb">HUGE</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
  <span class="k">DO </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">nPoints</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">DO WHILE</span><span class="p">(</span><span class="n">iLower</span><span class="p">.</span><span class="n">GE</span><span class="p">.</span><span class="mf">2.</span><span class="nb">AND</span><span class="p">.</span><span class="n">Cross</span><span class="p">(</span><span class="n">Lower</span><span class="p">(:,</span><span class="n">iLower</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span><span class="n">Lower</span><span class="p">(:,</span><span class="n">iLower</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">Points</span><span class="p">(:,</span><span class="n">i</span><span class="p">)).</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span>
      <span class="n">Lower</span><span class="p">(:,</span><span class="n">iLower</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="nb">HUGE</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
      <span class="n">iLower</span>          <span class="o">=</span> <span class="n">iLower</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">END DO</span>
<span class="k">    </span><span class="n">Lower</span><span class="p">(:,</span><span class="n">iLower</span><span class="p">)</span> <span class="o">=</span> <span class="n">Points</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
    <span class="n">iLower</span> <span class="o">=</span> <span class="n">iLower</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="k">END DO</span>

<span class="k">  </span><span class="n">iUpper</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">Upper</span>  <span class="o">=</span> <span class="nb">HUGE</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
  <span class="k">DO </span><span class="n">i</span><span class="o">=</span><span class="n">nPoints</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">DO WHILE</span><span class="p">(</span><span class="n">iUpper</span><span class="p">.</span><span class="n">GE</span><span class="p">.</span><span class="mf">2.</span><span class="nb">AND</span><span class="p">.</span><span class="n">Cross</span><span class="p">(</span><span class="n">Upper</span><span class="p">(:,</span><span class="n">iUpper</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span><span class="n">Upper</span><span class="p">(:,</span><span class="n">iUpper</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">Points</span><span class="p">(:,</span><span class="n">i</span><span class="p">)).</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span>
      <span class="n">Upper</span><span class="p">(:,</span><span class="n">iUpper</span><span class="p">)</span> <span class="o">=</span> <span class="nb">HUGE</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
      <span class="n">iUpper</span>          <span class="o">=</span> <span class="n">iUpper</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">END DO</span>
<span class="k">    </span><span class="n">Upper</span><span class="p">(:,</span><span class="n">iUpper</span><span class="p">)</span> <span class="o">=</span> <span class="n">Points</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
    <span class="n">iUpper</span> <span class="o">=</span> <span class="n">iUpper</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="k">END DO</span>

<span class="k">  </span><span class="n">iLower</span> <span class="o">=</span> <span class="n">iLower</span><span class="o">-</span><span class="mi">1</span>
  <span class="n">iUpper</span> <span class="o">=</span> <span class="n">iUpper</span><span class="o">-</span><span class="mi">1</span>
  <span class="n">nHull</span>  <span class="o">=</span> <span class="n">iLower</span><span class="o">+</span><span class="n">iUpper</span><span class="o">+</span><span class="mi">1</span>
  
  <span class="c">! NOTE: Initialize Hull with zeros</span>
  <span class="n">Hull</span>   <span class="o">=</span> <span class="mf">0.</span>

  <span class="c">! NOTE: save values in Hull</span>
  <span class="n">Hull</span><span class="p">(:,</span><span class="mi">0</span>     <span class="p">:</span><span class="n">iLower</span>       <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Lower</span><span class="p">(:,</span><span class="mi">0</span><span class="p">:</span><span class="n">iLower</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">Hull</span><span class="p">(:,</span><span class="n">iLower</span><span class="p">:</span><span class="n">iLower</span><span class="o">+</span><span class="n">iUpper</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Upper</span><span class="p">(:,</span><span class="mi">0</span><span class="p">:</span><span class="n">iUpper</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

  <span class="c">! NOTE: save first value twice</span>
  <span class="n">Hull</span><span class="p">(:,</span>       <span class="n">iLower</span><span class="o">+</span><span class="n">iUpper</span>  <span class="p">)</span> <span class="o">=</span> <span class="n">Hull</span> <span class="p">(:,</span><span class="mi">0</span>         <span class="p">)</span>
<span class="k">END IF</span>

<span class="k">END SUBROUTINE</span>
</pre></div>
<h2><span class="mw-headline" id="JavaScript">JavaScript</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=3" title="Edit section: JavaScript">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kd">function</span> <span class="nx">cross</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">return</span> <span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="nx">o</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="nx">o</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="nx">o</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="nx">o</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * @param points An array of [X, Y] coordinates</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">convexHull</span><span class="p">(</span><span class="nx">points</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">points</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">?</span> <span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="nx">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">:</span> <span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
   <span class="p">});</span>

   <span class="kd">var</span> <span class="nx">lower</span> <span class="o">=</span> <span class="p">[];</span>
   <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">points</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">while</span> <span class="p">(</span><span class="nx">lower</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nx">cross</span><span class="p">(</span><span class="nx">lower</span><span class="p">[</span><span class="nx">lower</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">2</span><span class="p">],</span> <span class="nx">lower</span><span class="p">[</span><span class="nx">lower</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="nx">points</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">lower</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
      <span class="p">}</span>
      <span class="nx">lower</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">points</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
   <span class="p">}</span>

   <span class="kd">var</span> <span class="nx">upper</span> <span class="o">=</span> <span class="p">[];</span>
   <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">points</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">while</span> <span class="p">(</span><span class="nx">upper</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nx">cross</span><span class="p">(</span><span class="nx">upper</span><span class="p">[</span><span class="nx">upper</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">2</span><span class="p">],</span> <span class="nx">upper</span><span class="p">[</span><span class="nx">upper</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="nx">points</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">upper</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
      <span class="p">}</span>
      <span class="nx">upper</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">points</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
   <span class="p">}</span>

   <span class="nx">upper</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
   <span class="nx">lower</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
   <span class="k">return</span> <span class="nx">lower</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">upper</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h2><span class="mw-headline" id="Java">Java</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=4" title="Edit section: Java">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.StringTokenizer</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">Point</span> <span class="kd">implements</span> <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="o">{</span>
	<span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">;</span>

	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="o">(</span><span class="n">Point</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">x</span> <span class="o">==</span> <span class="n">p</span><span class="o">.</span><span class="na">x</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">y</span> <span class="o">-</span> <span class="n">p</span><span class="o">.</span><span class="na">y</span><span class="o">;</span>
		<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
			<span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">x</span> <span class="o">-</span> <span class="n">p</span><span class="o">.</span><span class="na">x</span><span class="o">;</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">"("</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s">")"</span><span class="o">;</span>
	<span class="o">}</span>

<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConvexHull</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">cross</span><span class="o">(</span><span class="n">Point</span> <span class="n">O</span><span class="o">,</span> <span class="n">Point</span> <span class="n">A</span><span class="o">,</span> <span class="n">Point</span> <span class="n">B</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="o">(</span><span class="n">A</span><span class="o">.</span><span class="na">x</span> <span class="o">-</span> <span class="n">O</span><span class="o">.</span><span class="na">x</span><span class="o">)</span> <span class="o">*</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span> <span class="o">(</span><span class="n">B</span><span class="o">.</span><span class="na">y</span> <span class="o">-</span> <span class="n">O</span><span class="o">.</span><span class="na">y</span><span class="o">)</span> <span class="o">-</span> <span class="o">(</span><span class="n">A</span><span class="o">.</span><span class="na">y</span> <span class="o">-</span> <span class="n">O</span><span class="o">.</span><span class="na">y</span><span class="o">)</span> <span class="o">*</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span> <span class="o">(</span><span class="n">B</span><span class="o">.</span><span class="na">x</span> <span class="o">-</span> <span class="n">O</span><span class="o">.</span><span class="na">x</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="n">Point</span><span class="o">[]</span> <span class="nf">convex_hull</span><span class="o">(</span><span class="n">Point</span><span class="o">[]</span> <span class="n">P</span><span class="o">)</span> <span class="o">{</span>

		<span class="k">if</span> <span class="o">(</span><span class="n">P</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
			<span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="na">length</span><span class="o">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
			<span class="n">Point</span><span class="o">[]</span> <span class="n">H</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Point</span><span class="o">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span><span class="o">];</span>

			<span class="n">Arrays</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">P</span><span class="o">);</span>

			<span class="c1">// Build lower hull</span>
			<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
				<span class="k">while</span> <span class="o">(</span><span class="n">k</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">cross</span><span class="o">(</span><span class="n">H</span><span class="o">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="o">],</span> <span class="n">H</span><span class="o">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="o">],</span> <span class="n">P</span><span class="o">[</span><span class="n">i</span><span class="o">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span>
					<span class="n">k</span><span class="o">--;</span>
				<span class="n">H</span><span class="o">[</span><span class="n">k</span><span class="o">++]</span> <span class="o">=</span> <span class="n">P</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
			<span class="o">}</span>

			<span class="c1">// Build upper hull</span>
			<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="o">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">--)</span> <span class="o">{</span>
				<span class="k">while</span> <span class="o">(</span><span class="n">k</span> <span class="o">&gt;=</span> <span class="n">t</span> <span class="o">&amp;&amp;</span> <span class="n">cross</span><span class="o">(</span><span class="n">H</span><span class="o">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="o">],</span> <span class="n">H</span><span class="o">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="o">],</span> <span class="n">P</span><span class="o">[</span><span class="n">i</span><span class="o">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span>
					<span class="n">k</span><span class="o">--;</span>
				<span class="n">H</span><span class="o">[</span><span class="n">k</span><span class="o">++]</span> <span class="o">=</span> <span class="n">P</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
			<span class="o">}</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">H</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">copyOfRange</span><span class="o">(</span><span class="n">H</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span> <span class="c1">// remove non-hull vertices after k; remove k - 1 which is a duplicate</span>
			<span class="o">}</span>
			<span class="k">return</span> <span class="n">H</span><span class="o">;</span>
		<span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">P</span><span class="o">.</span><span class="na">length</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">return</span> <span class="n">P</span><span class="o">;</span>
		<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
			<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>

		<span class="n">BufferedReader</span> <span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="s">"hull.in"</span><span class="o">));</span> 	<span class="c1">// "hull.in"  Input Sample =&gt; size x y x y x y x y</span>
		<span class="n">StringTokenizer</span> <span class="n">st</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringTokenizer</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">readLine</span><span class="o">());</span>
		<span class="n">Point</span><span class="o">[]</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Point</span><span class="o">[</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">st</span><span class="o">.</span><span class="na">nextToken</span><span class="o">())];</span>
		<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">p</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
			<span class="n">p</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Point</span><span class="o">();</span>
			<span class="n">p</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">x</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">st</span><span class="o">.</span><span class="na">nextToken</span><span class="o">());</span> <span class="c1">// Read X coordinate </span>
			<span class="n">p</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">y</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">st</span><span class="o">.</span><span class="na">nextToken</span><span class="o">());</span> <span class="c1">// Read y coordinate</span>
		<span class="o">}</span>
		
		<span class="n">Point</span><span class="o">[]</span> <span class="n">hull</span> <span class="o">=</span> <span class="n">convex_hull</span><span class="o">(</span><span class="n">p</span><span class="o">).</span><span class="na">clone</span><span class="o">();</span>
		
		<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">hull</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">hull</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">hull</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
		<span class="o">}</span>
	<span class="o">}</span>

<span class="o">}</span>
</pre></div>
<h2><span class="mw-headline" id="Python">Python</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=5" title="Edit section: Python">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">convex_hull</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
    <span class="sd">"""Computes the convex hull of a set of 2D points.</span>

<span class="sd">    Input: an iterable sequence of (x, y) pairs representing the points.</span>
<span class="sd">    Output: a list of vertices of the convex hull in counter-clockwise order,</span>
<span class="sd">      starting from the vertex with the lexicographically smallest coordinates.</span>
<span class="sd">    Implements Andrew's monotone chain algorithm. O(n log n) complexity.</span>
<span class="sd">    """</span>

    <span class="c1"># Sort the points lexicographically (tuples are compared lexicographically).</span>
    <span class="c1"># Remove duplicates to detect the case we have just one unique point.</span>
    <span class="n">points</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">points</span><span class="p">))</span>

    <span class="c1"># Boring case: no points or a single point, possibly repeated multiple times.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">points</span>

    <span class="c1"># 2D cross product of OA and OB vectors, i.e. z-component of their 3D cross product.</span>
    <span class="c1"># Returns a positive value, if OAB makes a counter-clockwise turn,</span>
    <span class="c1"># negative for clockwise turn, and zero if the points are collinear.</span>
    <span class="k">def</span> <span class="nf">cross</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">o</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">o</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Build lower hull </span>
    <span class="n">lower</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">cross</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">lower</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lower</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">lower</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="c1"># Build upper hull</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">cross</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">upper</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">upper</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="c1"># Concatenation of the lower and upper hulls gives the convex hull.</span>
    <span class="c1"># Last point of each list is omitted because it is repeated at the beginning of the other list. </span>
    <span class="k">return</span> <span class="n">lower</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">upper</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Example: convex hull of a 10-by-10 grid.</span>
<span class="k">assert</span> <span class="n">convex_hull</span><span class="p">([(</span><span class="n">i</span><span class="o">//</span><span class="mi">10</span><span class="p">,</span> <span class="n">i</span><span class="o">%</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)])</span> <span class="o">==</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)]</span>
</pre></div>
<h2><span class="mw-headline" id="Ruby">Ruby</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=6" title="Edit section: Ruby">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># the python code converted to ruby syntax</span>
<span class="k">def</span> <span class="nf">convex_hull</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
  <span class="n">points</span><span class="o">.</span><span class="n">sort!</span><span class="o">.</span><span class="n">uniq!</span>
  <span class="k">return</span> <span class="n">points</span> <span class="k">if</span> <span class="n">points</span><span class="o">.</span><span class="n">length</span> <span class="o">&lt;=</span> <span class="mi">3</span>
  <span class="k">def</span> <span class="nf">cross</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="p">(</span><span class="n">a</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">-</span> <span class="n">o</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">-</span> <span class="n">o</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">-</span> <span class="n">o</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">-</span> <span class="n">o</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">)</span>
  <span class="k">end</span>
  <span class="n">lower</span> <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span>
  <span class="n">points</span><span class="o">.</span><span class="n">each</span><span class="p">{</span><span class="o">|</span><span class="nb">p</span><span class="o">|</span>
    <span class="k">while</span> <span class="n">lower</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cross</span><span class="p">(</span><span class="n">lower</span><span class="o">[-</span><span class="mi">2</span><span class="o">]</span><span class="p">,</span> <span class="n">lower</span><span class="o">[-</span><span class="mi">1</span><span class="o">]</span><span class="p">,</span> <span class="nb">p</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">do</span> <span class="n">lower</span><span class="o">.</span><span class="n">pop</span> <span class="k">end</span>
    <span class="n">lower</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="nb">p</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="n">upper</span> <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span>
  <span class="n">points</span><span class="o">.</span><span class="n">reverse_each</span><span class="p">{</span><span class="o">|</span><span class="nb">p</span><span class="o">|</span>
    <span class="k">while</span> <span class="n">upper</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">cross</span><span class="p">(</span><span class="n">upper</span><span class="o">[-</span><span class="mi">2</span><span class="o">]</span><span class="p">,</span> <span class="n">upper</span><span class="o">[-</span><span class="mi">1</span><span class="o">]</span><span class="p">,</span> <span class="nb">p</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">do</span> <span class="n">upper</span><span class="o">.</span><span class="n">pop</span> <span class="k">end</span>
    <span class="n">upper</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="nb">p</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">lower</span><span class="o">[</span><span class="mi">0</span><span class="o">...-</span><span class="mi">1</span><span class="o">]</span> <span class="o">+</span> <span class="n">upper</span><span class="o">[</span><span class="mi">0</span><span class="o">...-</span><span class="mi">1</span><span class="o">]</span>
<span class="k">end</span>
<span class="nb">fail</span> <span class="k">unless</span> <span class="n">convex_hull</span><span class="p">((</span><span class="mi">0</span><span class="o">..</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span><span class="o">.</span><span class="n">repeated_permutation</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span><span class="p">)</span> <span class="o">==</span> <span class="o">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="o">]</span><span class="p">,</span> <span class="o">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="o">]</span><span class="p">,</span> <span class="o">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="o">]</span><span class="p">,</span> <span class="o">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="o">]]</span>
</pre></div>
<h2><span id="C.2B.2B"></span><span class="mw-headline" id="C++">C++</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=7" title="Edit section: C++">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="c1">// Implementation of Andrew's monotone chain 2D convex hull algorithm.</span>
<span class="c1">// Asymptotic complexity: O(n log n).</span>
<span class="c1">// Practical performance: 0.5-1.0 seconds for n=1000000 on a 1GHz machine.</span>
<span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp"></span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="k">typedef</span> <span class="kt">double</span> <span class="n">coord_t</span><span class="p">;</span>         <span class="c1">// coordinate type</span>
<span class="k">typedef</span> <span class="kt">double</span> <span class="n">coord2_t</span><span class="p">;</span>  <span class="c1">// must be big enough to hold 2*max(|coordinate|)^2</span>

<span class="k">struct</span> <span class="n">Point</span> <span class="p">{</span>
	<span class="n">coord_t</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>

	<span class="kt">bool</span> <span class="k">operator</span> <span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">x</span> <span class="o">||</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">p</span><span class="p">.</span><span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">};</span>

<span class="c1">// 2D cross product of OA and OB vectors, i.e. z-component of their 3D cross product.</span>
<span class="c1">// Returns a positive value, if OAB makes a counter-clockwise turn,</span>
<span class="c1">// negative for clockwise turn, and zero if the points are collinear.</span>
<span class="n">coord2_t</span> <span class="nf">cross</span><span class="p">(</span><span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">O</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">A</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">B</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">O</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">B</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">O</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">O</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">B</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">O</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Returns a list of points on the convex hull in counter-clockwise order.</span>
<span class="c1">// Note: the last point in the returned list is the same as the first one.</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">convex_hull</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">size_t</span> <span class="n">n</span> <span class="o">=</span> <span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">return</span> <span class="n">P</span><span class="p">;</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">);</span>

	<span class="c1">// Sort points lexicographically</span>
	<span class="n">sort</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">P</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>

	<span class="c1">// Build lower hull</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">while</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">cross</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">k</span><span class="o">--</span><span class="p">;</span>
		<span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
	<span class="p">}</span>

	<span class="c1">// Build upper hull</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">while</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;=</span> <span class="n">t</span> <span class="o">&amp;&amp;</span> <span class="n">cross</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">k</span><span class="o">--</span><span class="p">;</span>
		<span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
	<span class="p">}</span>

	<span class="n">H</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">H</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h2><span class="mw-headline" id="Perl">Perl</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=8" title="Edit section: Perl">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">use</span> <span class="nn">Sort::Key::Radix</span> <span class="sx">qw(nkeysort)</span><span class="p">;</span> <span class="c1"># use radix sort for an O(n) algorithm</span>

<span class="k">sub</span> <span class="nf">convex_hull</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">@_</span> <span class="k">if</span> <span class="nv">@_</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">;</span>

    <span class="k">my</span> <span class="nv">@p</span> <span class="o">=</span> <span class="n">nkeysort</span> <span class="p">{</span> <span class="nv">$_</span><span class="o">-&gt;</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">}</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="k">my</span> <span class="p">(</span><span class="nv">@u</span><span class="p">,</span> <span class="nv">@l</span><span class="p">);</span>
    <span class="k">my</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">@p</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">my</span> <span class="nv">$iu</span> <span class="o">=</span> <span class="k">my</span> <span class="nv">$il</span> <span class="o">=</span> <span class="nv">$i</span><span class="p">;</span>
        <span class="k">my</span> <span class="p">(</span><span class="nv">$x</span><span class="p">,</span> <span class="nv">$yu</span><span class="p">)</span> <span class="o">=</span> <span class="nv">@</span><span class="p">{</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]};</span>
        <span class="k">my</span> <span class="nv">$yl</span> <span class="o">=</span> <span class="nv">$yu</span><span class="p">;</span>
        <span class="c1"># search for upper and lower Y for the current X</span>
        <span class="k">while</span> <span class="p">(</span><span class="o">++</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">@p</span> <span class="ow">and</span> <span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$x</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">my</span> <span class="nv">$y</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$y</span> <span class="o">&lt;</span> <span class="nv">$yl</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$il</span> <span class="o">=</span> <span class="nv">$i</span><span class="p">;</span>
                <span class="nv">$yl</span> <span class="o">=</span> <span class="nv">$y</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">elsif</span> <span class="p">(</span><span class="nv">$y</span> <span class="o">&gt;</span> <span class="nv">$yu</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$iu</span> <span class="o">=</span> <span class="nv">$i</span><span class="p">;</span>
                <span class="nv">$yu</span> <span class="o">=</span> <span class="nv">$y</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">@l</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">my</span> <span class="p">(</span><span class="nv">$ox</span><span class="p">,</span> <span class="nv">$oy</span><span class="p">)</span> <span class="o">=</span> <span class="nv">@</span><span class="p">{</span><span class="nv">$l</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]};</span>
            <span class="k">last</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$l</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$oy</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nv">$x</span> <span class="o">-</span> <span class="nv">$ox</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nv">$yl</span> <span class="o">-</span> <span class="nv">$oy</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nv">$l</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$ox</span><span class="p">);</span>
            <span class="nb">pop</span> <span class="nv">@l</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nb">push</span> <span class="nv">@l</span><span class="p">,</span> <span class="nv">$p</span><span class="p">[</span><span class="nv">$il</span><span class="p">];</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">@u</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">my</span> <span class="p">(</span><span class="nv">$ox</span><span class="p">,</span> <span class="nv">$oy</span><span class="p">)</span> <span class="o">=</span> <span class="nv">@</span><span class="p">{</span><span class="nv">$u</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]};</span>
            <span class="k">last</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$u</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$oy</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nv">$x</span> <span class="o">-</span> <span class="nv">$ox</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="nv">$yu</span> <span class="o">-</span> <span class="nv">$oy</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nv">$u</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$ox</span><span class="p">);</span>
            <span class="nb">pop</span> <span class="nv">@u</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nb">push</span> <span class="nv">@u</span><span class="p">,</span> <span class="nv">$p</span><span class="p">[</span><span class="nv">$iu</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="c1"># remove points from the upper hull extremes when they are already</span>
    <span class="c1"># on the lower hull:</span>
    <span class="nb">shift</span> <span class="nv">@u</span> <span class="k">if</span> <span class="nv">$u</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$l</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span>
    <span class="nb">pop</span> <span class="nv">@u</span> <span class="k">if</span> <span class="nv">@u</span> <span class="ow">and</span> <span class="nv">$u</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$l</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span>

    <span class="k">return</span> <span class="p">(</span><span class="nv">@l</span><span class="p">,</span> <span class="nb">reverse</span> <span class="nv">@u</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h2><span class="mw-headline" id="C">C</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=9" title="Edit section: C">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>C sources taken from the Math::ConvexHull::MonotoneChain Perl module. Note that this implementation works on sorted input points. Otherwise, it's rather similar to the C++ implementation above.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
  <span class="kt">double</span> <span class="n">x</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">y</span><span class="p">;</span>
<span class="p">}</span> <span class="n">point_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="n">point_t</span><span class="o">*</span> <span class="n">point_ptr_t</span><span class="p">;</span>

<span class="cm">/* Three points are a counter-clockwise turn if ccw &gt; 0, clockwise if</span>
<span class="cm"> * ccw &lt; 0, and collinear if ccw = 0 because ccw is a determinant that</span>
<span class="cm"> * gives the signed area of the triangle formed by p1, p2 and p3.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">double</span>
<span class="nf">ccw</span><span class="p">(</span><span class="n">point_t</span><span class="o">*</span> <span class="n">p1</span><span class="p">,</span> <span class="n">point_t</span><span class="o">*</span> <span class="n">p2</span><span class="p">,</span> <span class="n">point_t</span><span class="o">*</span> <span class="n">p3</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">p2</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">-</span> <span class="n">p1</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p3</span><span class="o">-&gt;</span><span class="n">y</span> <span class="o">-</span> <span class="n">p1</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">p2</span><span class="o">-&gt;</span><span class="n">y</span> <span class="o">-</span> <span class="n">p1</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p3</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">-</span> <span class="n">p1</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Returns a list of points on the convex hull in counter-clockwise order.</span>
<span class="cm"> * Note: the last point in the returned list is the same as the first one.</span>
<span class="cm"> */</span>
<span class="kt">void</span>
<span class="nf">convex_hull</span><span class="p">(</span><span class="n">point_t</span><span class="o">*</span> <span class="n">points</span><span class="p">,</span> <span class="kt">ssize_t</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">point_ptr_t</span><span class="o">**</span> <span class="n">out_hull</span><span class="p">,</span> <span class="kt">ssize_t</span><span class="o">*</span> <span class="n">out_hullsize</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">point_ptr_t</span><span class="o">*</span> <span class="n">hull</span><span class="p">;</span>
  <span class="kt">ssize_t</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="n">hull</span> <span class="o">=</span> <span class="o">*</span><span class="n">out_hull</span><span class="p">;</span>

  <span class="cm">/* lower hull */</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">npoints</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">ccw</span><span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">--</span><span class="n">k</span><span class="p">;</span>
    <span class="n">hull</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="p">}</span>

  <span class="cm">/* upper hull */</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">npoints</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;=</span> <span class="n">t</span> <span class="o">&amp;&amp;</span> <span class="n">ccw</span><span class="p">(</span><span class="n">hull</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">hull</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">--</span><span class="n">k</span><span class="p">;</span>
    <span class="n">hull</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="p">}</span>

  <span class="o">*</span><span class="n">out_hull</span> <span class="o">=</span> <span class="n">hull</span><span class="p">;</span>
  <span class="o">*</span><span class="n">out_hullsize</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<h2><span class="mw-headline" id="Haskell">Haskell</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=10" title="Edit section: Haskell">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kr">import</span> <span class="nn">Data.List</span> <span class="p">(</span><span class="nf">sort</span><span class="p">)</span>

<span class="c1">-- Coordinate type</span>
<span class="kr">type</span> <span class="kt">R</span> <span class="ow">=</span> <span class="kt">Double</span>

<span class="c1">-- Vector / point type</span>
<span class="kr">type</span> <span class="kt">R2</span> <span class="ow">=</span> <span class="p">(</span><span class="kt">R</span><span class="p">,</span> <span class="kt">R</span><span class="p">)</span>

<span class="c1">-- Checks if it's shortest to rotate from the OA to the OB vector in a clockwise</span>
<span class="c1">-- direction.</span>
<span class="nf">clockwise</span> <span class="ow">::</span> <span class="kt">R2</span> <span class="ow">-&gt;</span> <span class="kt">R2</span> <span class="ow">-&gt;</span> <span class="kt">R2</span> <span class="ow">-&gt;</span> <span class="kt">Bool</span>
<span class="nf">clockwise</span> <span class="n">o</span> <span class="n">a</span> <span class="n">b</span> <span class="ow">=</span> <span class="p">(</span><span class="n">a</span> <span class="p">`</span><span class="n">sub</span><span class="p">`</span> <span class="n">o</span><span class="p">)</span> <span class="p">`</span><span class="n">cross</span><span class="p">`</span> <span class="p">(</span><span class="n">b</span> <span class="p">`</span><span class="n">sub</span><span class="p">`</span> <span class="n">o</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span>

<span class="c1">-- 2D cross product.</span>
<span class="nf">cross</span> <span class="ow">::</span> <span class="kt">R2</span> <span class="ow">-&gt;</span> <span class="kt">R2</span> <span class="ow">-&gt;</span> <span class="kt">R</span>
<span class="nf">cross</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="ow">=</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">y1</span>

<span class="c1">-- Subtract two vectors.</span>
<span class="nf">sub</span> <span class="ow">::</span> <span class="kt">R2</span> <span class="ow">-&gt;</span> <span class="kt">R2</span> <span class="ow">-&gt;</span> <span class="kt">R2</span>
<span class="nf">sub</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="ow">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)</span>

<span class="c1">-- Implements the monotone chain algorithm</span>
<span class="nf">convexHull</span> <span class="ow">::</span> <span class="p">[</span><span class="kt">R2</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="kt">R2</span><span class="p">]</span>
<span class="nf">convexHull</span> <span class="kt">[]</span> <span class="ow">=</span> <span class="kt">[]</span>
<span class="nf">convexHull</span> <span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="ow">=</span> <span class="p">[</span><span class="n">p</span><span class="p">]</span>
<span class="nf">convexHull</span> <span class="n">points</span> <span class="ow">=</span> <span class="n">lower</span> <span class="o">++</span> <span class="n">upper</span>
  <span class="kr">where</span>
    <span class="n">sorted</span> <span class="ow">=</span> <span class="n">sort</span> <span class="n">points</span>
    <span class="n">lower</span> <span class="ow">=</span> <span class="n">chain</span> <span class="n">sorted</span>
    <span class="n">upper</span> <span class="ow">=</span> <span class="n">chain</span> <span class="p">(</span><span class="n">reverse</span> <span class="n">sorted</span><span class="p">)</span>

<span class="nf">chain</span> <span class="ow">::</span> <span class="p">[</span><span class="kt">R2</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="kt">R2</span><span class="p">]</span>
<span class="nf">chain</span> <span class="ow">=</span> <span class="n">go</span> <span class="kt">[]</span>
  <span class="kr">where</span>
    <span class="c1">-- The first parameter accumulates a monotone chain where the most recently</span>
    <span class="c1">-- added element is at the front of the list.</span>
    <span class="n">go</span> <span class="ow">::</span> <span class="p">[</span><span class="kt">R2</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="kt">R2</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="kt">R2</span><span class="p">]</span>
    <span class="n">go</span> <span class="n">acc</span><span class="o">@</span><span class="p">(</span><span class="n">r1</span><span class="kt">:</span><span class="n">r2</span><span class="kt">:</span><span class="n">rs</span><span class="p">)</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="ow">=</span>
      <span class="kr">if</span> <span class="n">clockwise</span> <span class="n">r2</span> <span class="n">r1</span> <span class="n">x</span>
        <span class="c1">-- Made a clockwise turn - remove the most recent part of the chain.</span>
        <span class="kr">then</span> <span class="n">go</span> <span class="p">(</span><span class="n">r2</span><span class="kt">:</span><span class="n">rs</span><span class="p">)</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span>
        <span class="c1">-- Made a counter-clockwise turn - append to the chain.</span>
        <span class="kr">else</span> <span class="n">go</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">acc</span><span class="p">)</span> <span class="n">xs</span>
    <span class="c1">-- If there's only one point in the chain, just add the next visited point.</span>
    <span class="n">go</span> <span class="n">acc</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="ow">=</span> <span class="n">go</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">acc</span><span class="p">)</span> <span class="n">xs</span>
    <span class="c1">-- No more points to consume - finished!  Note: the reverse here causes the</span>
    <span class="c1">-- result to be consistent with the other examples (a ccw hull), but</span>
    <span class="c1">-- removing that and using (upper ++ lower) above will make it cw.</span>
    <span class="n">go</span> <span class="n">acc</span> <span class="kt">[]</span> <span class="ow">=</span> <span class="n">reverse</span> <span class="o">$</span> <span class="n">tail</span> <span class="n">acc</span>

<span class="nf">main</span> <span class="ow">::</span> <span class="kt">IO</span> <span class="nb">()</span>
<span class="nf">main</span> <span class="ow">=</span>
    <span class="kr">if</span> <span class="n">result</span> <span class="o">==</span> <span class="n">expected</span>
      <span class="kr">then</span> <span class="n">putStrLn</span> <span class="s">"convexHull worked!"</span>
      <span class="kr">else</span> <span class="n">fail</span> <span class="o">$</span> <span class="s">"convexHull broken, got "</span> <span class="o">++</span> <span class="n">show</span> <span class="n">result</span>
  <span class="kr">where</span>
    <span class="n">result</span> <span class="ow">=</span> <span class="n">convexHull</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">|</span> <span class="n">x</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">9</span><span class="p">],</span> <span class="n">y</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">9</span><span class="p">]]</span>
    <span class="n">expected</span> <span class="ow">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)]</span>
</pre></div>
<h2><span class="mw-headline" id="Elixir">Elixir</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=11" title="Edit section: Elixir">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kd">defmodule</span> <span class="nc">ConvexHull</span> <span class="k">do</span>
  <span class="na">@type</span> <span class="n">coordinate</span> <span class="o">::</span> <span class="p">{</span><span class="n">number</span><span class="p">,</span> <span class="n">number</span><span class="p">}</span>
  <span class="na">@type</span> <span class="n">point_list</span> <span class="o">::</span> <span class="p">[</span><span class="n">coordinate</span><span class="p">]</span>

  <span class="na">@spec</span> <span class="n">find</span><span class="p">(</span><span class="n">point_list</span><span class="p">)</span> <span class="o">::</span> <span class="n">point_list</span>
  <span class="kd">def</span> <span class="n">find</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">sorted</span> <span class="o">=</span> <span class="n">points</span> <span class="o">|&gt;</span> <span class="nc">Enum</span><span class="o">.</span><span class="n">sort</span>
    <span class="n">left</span> <span class="o">=</span> <span class="n">sorted</span> <span class="o">|&gt;</span> <span class="n">do_half_calc</span>
    <span class="n">right</span> <span class="o">=</span> <span class="n">sorted</span> <span class="o">|&gt;</span> <span class="nc">Enum</span><span class="o">.</span><span class="n">reverse</span> <span class="o">|&gt;</span> <span class="n">do_half_calc</span>
    <span class="p">[</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">]</span> <span class="o">|&gt;</span> <span class="nc">Enum</span><span class="o">.</span><span class="n">concat</span>
  <span class="k">end</span>

  <span class="na">@spec</span> <span class="n">do_half_calc</span><span class="p">(</span><span class="n">point_list</span><span class="p">)</span> <span class="o">::</span> <span class="n">point_list</span>
  <span class="kd">defp</span> <span class="n">do_half_calc</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">points</span>
    <span class="o">|&gt;</span> <span class="nc">Enum</span><span class="o">.</span><span class="n">reduce</span><span class="p">([],</span> <span class="o">&amp;</span><span class="n">add_to_convex_list</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="o">|&gt;</span> <span class="n">tl</span>
    <span class="o">|&gt;</span> <span class="nc">Enum</span><span class="o">.</span><span class="n">reverse</span>
  <span class="k">end</span>

  <span class="na">@spec</span> <span class="n">perp_prod</span><span class="p">(</span><span class="n">coordinate</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">)</span> <span class="o">::</span> <span class="n">number</span>
  <span class="kd">defp</span> <span class="n">perp_prod</span><span class="p">({</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">},</span> <span class="p">{</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">},</span> <span class="p">{</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">})</span> <span class="k">do</span>
    <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> 
  <span class="k">end</span>

  <span class="na">@spec</span> <span class="n">add_to_convex_list</span><span class="p">(</span><span class="n">coordinate</span><span class="p">,</span> <span class="n">point_list</span><span class="p">)</span> <span class="o">::</span> <span class="n">point_list</span>
  <span class="kd">defp</span> <span class="n">add_to_convex_list</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">list</span><span class="p">)</span> <span class="k">do</span>
    <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span> <span class="n">new_tail</span><span class="p">}</span> <span class="o">=</span>
      <span class="n">list</span>
      <span class="o">|&gt;</span> <span class="n">stream_tails</span>
      <span class="o">|&gt;</span> <span class="nc">Stream</span><span class="o">.</span><span class="n">drop_while</span><span class="p">(</span><span class="k">fn</span> <span class="n">tail</span> <span class="o">-&gt;</span> <span class="n">oa_left_of_ob</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">tail</span><span class="p">)</span> <span class="k">end</span><span class="p">)</span>
      <span class="o">|&gt;</span> <span class="nc">Enum</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">[</span><span class="n">p2</span> <span class="o">|</span> <span class="n">new_tail</span><span class="p">]</span>
  <span class="k">end</span>

  <span class="na">@spec</span> <span class="n">oa_left_of_ob</span><span class="p">(</span><span class="n">coordinate</span><span class="p">,</span> <span class="n">point_list</span><span class="p">)</span> <span class="o">::</span> <span class="n">number</span>
  <span class="kd">defp</span> <span class="n">oa_left_of_ob</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">o</span> <span class="o">|</span> <span class="bp">_</span><span class="p">]),</span> <span class="ss">do</span><span class="p">:</span> <span class="n">perp_prod</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span>
  <span class="kd">defp</span> <span class="n">oa_left_of_ob</span><span class="p">(</span><span class="bp">_</span><span class="p">,</span> <span class="bp">_</span><span class="p">),</span> <span class="ss">do</span><span class="p">:</span> <span class="no">false</span>

  <span class="na">@spec</span> <span class="n">stream_tails</span><span class="p">(</span><span class="n">point_list</span><span class="p">)</span> <span class="o">::</span> <span class="nc">Enum</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="n">point_list</span><span class="p">)</span> 
  <span class="kd">defp</span> <span class="n">stream_tails</span><span class="p">(</span><span class="n">list</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">tails</span> <span class="o">=</span> <span class="nc">Stream</span><span class="o">.</span><span class="n">unfold</span><span class="p">(</span><span class="n">list</span><span class="p">,</span> <span class="k">fn</span> <span class="p">[</span><span class="bp">_</span> <span class="o">|</span> <span class="n">t</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">}</span> <span class="k">end</span><span class="p">)</span>
    <span class="nc">Stream</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">list</span><span class="p">],</span> <span class="n">tails</span><span class="p">)</span>
  <span class="k">end</span>

<span class="k">end</span>

<span class="nc">ExUnit</span><span class="o">.</span><span class="n">start</span>

<span class="kd">defmodule</span> <span class="nc">ConvexHullStart</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="nc">ExUnit.Case</span><span class="p">,</span> <span class="ss">async</span><span class="p">:</span> <span class="no">true</span>

  <span class="na">@points</span> <span class="k">for</span> <span class="n">x</span> <span class="o">&lt;-</span> <span class="mi">0</span><span class="o">..</span><span class="mi">9</span><span class="p">,</span> <span class="n">y</span> <span class="o">&lt;-</span> <span class="mi">0</span><span class="o">..</span><span class="mi">9</span><span class="p">,</span> <span class="ss">do</span><span class="p">:</span> <span class="p">{</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">}</span>

  <span class="n">test</span> <span class="s2">"finding the convex hull for all points (0,0) .. (9,9)"</span> <span class="k">do</span>
    <span class="n">assert</span> <span class="nc">ConvexHull</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="na">@points</span><span class="p">)</span> <span class="o">==</span> <span class="p">[{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">},</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">}]</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
<h2><span class="mw-headline" id="Clojure">Clojure</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=12" title="Edit section: Clojure">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="p">(</span><span class="kd">defn </span><span class="nv">convex-hull</span>
<span class="s">"The function convex-hull accepts a collection of vectors containing pairs of numbers</span>
<span class="s"> which define the [x y] bounds of the polygon,</span>
<span class="s"> e.g. [[0 0] [0 1] [0 2] [0 3]</span>
<span class="s">       [1 0] [1 1] [1 2] [1 3]</span>
<span class="s">       [2 0] [2 1] [2 2] [2 3] [2 4] [2 5] [2 6] [2 7] [2 8] [2 9]</span>
<span class="s">       [3 0] [3 1] [3 2] [3 3]</span>
<span class="s">       [4 0] [4 1] [4 2] [4 3] [4 4]</span>
<span class="s">             [5 1]]</span>

<span class="s"> When run on the above collection of points the output will be</span>
<span class="s">   [[0 0] [0 3] [2 9] [4 4] [5 1] [4 0]]</span>
<span class="s">             </span>
<span class="s"> The input collection of vectors can be either a vector ( e.g. [[0 0] [1 1] [2 2]]) or a quoted sequence</span>
<span class="s"> (e.g. '([0 0] [1 1] [2 2]) or (quote ([0 0] [1 1] [2 2])).</span>
<span class="s"> </span>
<span class="s"> The output collection will always be a vector of vectors (e.g. [[0 0] [0 9] [9 9] [9 0]]) which</span>
<span class="s"> define the bounds of the convex hull."</span>
  <span class="p">[</span><span class="nv">c</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">cc</span>         <span class="p">(</span><span class="nb">sort-by identity </span><span class="nv">c</span><span class="p">)</span>
        <span class="nv">x</span>          <span class="o">#</span><span class="p">(</span><span class="nb">first </span><span class="nv">%</span><span class="p">)</span>    <span class="c1">; returns the 'x' coordinate from an [x y] vector</span>
        <span class="nv">y</span>          <span class="o">#</span><span class="p">(</span><span class="nb">second </span><span class="nv">%</span><span class="p">)</span>   <span class="c1">; returns the 'y' coordinate from an [x y] vector</span>
        <span class="nv">ccw</span>        <span class="o">#</span><span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">x</span> <span class="nv">%2</span><span class="p">)</span> <span class="p">(</span><span class="nf">x</span> <span class="nv">%1</span><span class="p">))</span> <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">y</span> <span class="nv">%3</span><span class="p">)</span> <span class="p">(</span><span class="nf">y</span> <span class="nv">%1</span><span class="p">)))</span> <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">y</span> <span class="nv">%2</span><span class="p">)</span> <span class="p">(</span><span class="nf">y</span> <span class="nv">%1</span><span class="p">))</span> <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">x</span> <span class="nv">%3</span><span class="p">)</span> <span class="p">(</span><span class="nf">x</span> <span class="nv">%1</span><span class="p">))))</span> 
        <span class="nv">half-hull</span>  <span class="o">#</span><span class="p">(</span><span class="k">loop </span><span class="p">[</span><span class="nv">h</span>  <span class="p">[]</span> <span class="c1">; returns the upper half-hull of the collection of vectors</span>
                           <span class="nv">c</span>  <span class="nv">%</span><span class="p">]</span>
                      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">c</span><span class="p">))</span>
                        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">and </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nb">count </span><span class="nv">h</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">&lt;= </span><span class="mi">0</span> <span class="p">(</span><span class="nf">ccw</span> <span class="p">(</span><span class="nf">h</span> <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nb">count </span><span class="nv">h</span><span class="p">)</span> <span class="mi">2</span><span class="p">))</span> <span class="p">(</span><span class="nf">h</span> <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nb">count </span><span class="nv">h</span><span class="p">)</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nb">first </span><span class="nv">c</span><span class="p">))))</span>
                          <span class="p">(</span><span class="nf">recur</span> <span class="p">(</span><span class="nf">vec</span> <span class="p">(</span><span class="nb">butlast </span><span class="nv">h</span><span class="p">))</span> <span class="nv">c</span><span class="p">)</span>
                          <span class="p">(</span><span class="nf">recur</span> <span class="p">(</span><span class="nb">conj </span><span class="nv">h</span> <span class="p">(</span><span class="nb">first </span><span class="nv">c</span><span class="p">))</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">c</span><span class="p">)))</span>
                        <span class="nv">h</span><span class="p">))</span>
       <span class="nv">upper-hull</span>  <span class="p">(</span><span class="nb">butlast </span><span class="p">(</span><span class="nf">half-hull</span> <span class="nv">cc</span><span class="p">))</span>
       <span class="nv">lower-hull</span>  <span class="p">(</span><span class="nb">butlast </span><span class="p">(</span><span class="nf">half-hull</span> <span class="p">(</span><span class="nb">reverse </span><span class="nv">cc</span><span class="p">)))]</span>
    <span class="p">(</span><span class="nf">vec</span> <span class="p">(</span><span class="nb">concat </span><span class="nv">upper-hull</span> <span class="nv">lower-hull</span> <span class="p">))))</span>
</pre></div>
<h2><span class="mw-headline" id="Scala">Scala</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=13" title="Edit section: Scala">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">import</span> <span class="nn">scala.collection.mutable.ArrayBuffer</span>
  
  <span class="k">def</span> <span class="n">convexHull</span><span class="o">(</span><span class="n">points</span><span class="k">:</span> <span class="kt">ArrayBuffer</span><span class="o">[(</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">)])</span><span class="k">:</span> <span class="kt">ArrayBuffer</span><span class="o">[(</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="o">{</span>
    
    
    <span class="c1">// 2D cross product of OA and OB vectors, i.e. z-component of their 3D cross product.</span>
    <span class="c1">// Returns a positive value, if OAB makes a counter-clockwise turn,</span>
    <span class="c1">// negative for clockwise turn, and zero if the points are collinear.</span>
    <span class="k">def</span> <span class="n">cross</span><span class="o">(</span><span class="n">o</span><span class="k">:</span> <span class="o">(</span><span class="kt">Int</span><span class="o">,</span> <span class="kt">Int</span><span class="o">),</span> <span class="n">a</span><span class="k">:</span> <span class="o">(</span><span class="kt">Int</span><span class="o">,</span> <span class="kt">Int</span><span class="o">),</span> <span class="n">b</span><span class="k">:</span> <span class="o">(</span><span class="kt">Int</span><span class="o">,</span> <span class="kt">Int</span><span class="o">))</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">{</span>
      <span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="n">_1</span> <span class="o">-</span> <span class="n">o</span><span class="o">.</span><span class="n">_1</span><span class="o">)</span> <span class="o">*</span> <span class="o">(</span><span class="n">b</span><span class="o">.</span><span class="n">_2</span> <span class="o">-</span> <span class="n">o</span><span class="o">.</span><span class="n">_2</span><span class="o">)</span> <span class="o">-</span> <span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="n">_2</span> <span class="o">-</span> <span class="n">o</span><span class="o">.</span><span class="n">_2</span><span class="o">)</span> <span class="o">*</span> <span class="o">(</span><span class="n">b</span><span class="o">.</span><span class="n">_1</span> <span class="o">-</span> <span class="n">o</span><span class="o">.</span><span class="n">_1</span><span class="o">)</span>
    <span class="o">}</span>
    
    <span class="k">val</span> <span class="n">distinctPoints</span> <span class="k">=</span> <span class="n">points</span><span class="o">.</span><span class="n">distinct</span>
    
    <span class="c1">// No sorting needed if there are less than 2 unique points.</span>
    <span class="k">if</span><span class="o">(</span><span class="n">distinctPoints</span><span class="o">.</span><span class="n">length</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">points</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      
      <span class="k">val</span> <span class="n">sortedPoints</span> <span class="k">=</span> <span class="n">distinctPoints</span><span class="o">.</span><span class="n">sorted</span>
      
      <span class="c1">// Build the lower hull</span>
      <span class="k">val</span> <span class="n">lower</span> <span class="k">=</span> <span class="nc">ArrayBuffer</span><span class="o">[(</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">)]()</span>
      <span class="k">for</span><span class="o">(</span><span class="n">i</span> <span class="k">&lt;-</span> <span class="n">sortedPoints</span><span class="o">){</span>
        <span class="k">while</span><span class="o">(</span><span class="n">lower</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">cross</span><span class="o">(</span><span class="n">lower</span><span class="o">(</span><span class="n">lower</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">2</span><span class="o">),</span> <span class="n">lower</span><span class="o">(</span><span class="n">lower</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">){</span>
          <span class="n">lower</span> <span class="o">-=</span> <span class="n">lower</span><span class="o">.</span><span class="n">last</span>
        <span class="o">}</span>
        <span class="n">lower</span> <span class="o">+=</span> <span class="n">i</span>
      <span class="o">}</span>
      
      <span class="c1">// Build the upper hull</span>
      <span class="k">val</span> <span class="n">upper</span> <span class="k">=</span> <span class="nc">ArrayBuffer</span><span class="o">[(</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">)]()</span>
      <span class="k">for</span><span class="o">(</span><span class="n">i</span> <span class="k">&lt;-</span> <span class="n">sortedPoints</span><span class="o">.</span><span class="n">reverse</span><span class="o">){</span>
        <span class="k">while</span><span class="o">(</span><span class="n">upper</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">cross</span><span class="o">(</span><span class="n">upper</span><span class="o">(</span><span class="n">upper</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">2</span><span class="o">),</span> <span class="n">upper</span><span class="o">(</span><span class="n">upper</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">){</span>
          <span class="n">upper</span> <span class="o">-=</span> <span class="n">upper</span><span class="o">.</span><span class="n">last</span>
        <span class="o">}</span>
        <span class="n">upper</span> <span class="o">+=</span> <span class="n">i</span>
      <span class="o">}</span>
      
      <span class="c1">// Last point of each list is omitted because it is repeated at the beginning of the other list.</span>
      <span class="n">lower</span> <span class="o">-=</span> <span class="n">lower</span><span class="o">.</span><span class="n">last</span>
      <span class="n">upper</span> <span class="o">-=</span> <span class="n">upper</span><span class="o">.</span><span class="n">last</span>
      
      <span class="c1">// Concatenation of the lower and upper hulls gives the convex hull</span>
      <span class="k">return</span> <span class="n">lower</span> <span class="o">++=</span> <span class="n">upper</span>
    <span class="o">}</span>
  <span class="o">}</span>
</pre></div>
<p><br>
</p>
<h2><span class="mw-headline" id="PHP">PHP</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=14" title="Edit section: PHP">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="nv">$coords</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span>
        <span class="s1">'x'</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">point_0_x</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s1">'y'</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">point_0_y</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="s1">'x'</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">point_1_x</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s1">'y'</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">point_1_y</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="s1">'x'</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">point_n_x</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s1">'y'</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">point_n_y</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">];</span>

<span class="k">function</span> <span class="nf">orientation</span><span class="p">(</span><span class="k">array</span> <span class="nv">$coord1</span><span class="p">,</span> <span class="k">array</span> <span class="nv">$coord2</span><span class="p">,</span> <span class="k">array</span> <span class="nv">$coord3</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nv">$coord2</span><span class="p">[</span><span class="s1">'x'</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$coord1</span><span class="p">[</span><span class="s1">'x'</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="nv">$coord3</span><span class="p">[</span><span class="s1">'y'</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$coord1</span><span class="p">[</span><span class="s1">'y'</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="nv">$coord2</span><span class="p">[</span><span class="s1">'y'</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$coord1</span><span class="p">[</span><span class="s1">'y'</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="nv">$coord3</span><span class="p">[</span><span class="s1">'x'</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$coord1</span><span class="p">[</span><span class="s1">'x'</span><span class="p">]);</span>
<span class="p">}</span>

<span class="nb">usort</span><span class="p">(</span><span class="nv">$coords</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$a</span><span class="p">[</span><span class="s1">'x'</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$b</span><span class="p">[</span><span class="s1">'x'</span><span class="p">]</span> <span class="o">?</span> <span class="nv">$a</span><span class="p">[</span><span class="s1">'y'</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$b</span><span class="p">[</span><span class="s1">'y'</span><span class="p">]</span> <span class="o">:</span> <span class="nv">$a</span><span class="p">[</span><span class="s1">'x'</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$b</span><span class="p">[</span><span class="s1">'x'</span><span class="p">];</span> <span class="p">});</span>

<span class="nv">$upper_hulls</span> <span class="o">=</span> <span class="nv">$lower_hulls</span> <span class="o">=</span> <span class="p">[];</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$coords</span> <span class="k">as</span> <span class="nv">$coord</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$last_two</span> <span class="o">=</span> <span class="nb">array_slice</span><span class="p">(</span><span class="nv">$lower_hulls</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nx">orientation</span><span class="p">(</span><span class="nv">$last_two</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$last_two</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$coord</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">array_pop</span><span class="p">(</span><span class="nv">$lower_hulls</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nv">$lower_hulls</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$coord</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nb">array_reverse</span><span class="p">(</span><span class="nv">$coords</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$coord</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$last_two</span> <span class="o">=</span> <span class="nb">array_slice</span><span class="p">(</span><span class="nv">$upper_hulls</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nx">orientation</span><span class="p">(</span><span class="nv">$last_two</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$last_two</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$coord</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">array_pop</span><span class="p">(</span><span class="nv">$upper_hulls</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nv">$upper_hulls</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$coord</span><span class="p">;</span>
<span class="p">}</span>

<span class="nb">array_pop</span><span class="p">(</span><span class="nv">$upper_hulls</span><span class="p">);</span>
<span class="nb">array_pop</span><span class="p">(</span><span class="nv">$lower_hulls</span><span class="p">);</span>

<span class="k">return</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$upper_hulls</span><span class="p">,</span> <span class="nv">$lower_hulls</span><span class="p">);</span>
</pre></div>
<h2><span class="mw-headline" id="Swift">Swift</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=15" title="Edit section: Swift">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="kd">import</span> <span class="nc">Foundation</span>

<span class="kd">public</span> <span class="kd">func</span> <span class="nf">cross</span><span class="p">(</span><span class="kc">_</span> <span class="n">o</span><span class="p">:</span> <span class="bp">CGPoint</span><span class="p">,</span> <span class="kc">_</span> <span class="n">a</span><span class="p">:</span> <span class="bp">CGPoint</span><span class="p">,</span> <span class="kc">_</span> <span class="n">b</span><span class="p">:</span> <span class="bp">CGPoint</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">CGFloat</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nv">lhs</span> <span class="p">=</span> <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">o</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">o</span><span class="p">.</span><span class="n">y</span><span class="p">)</span>
    <span class="kd">let</span> <span class="nv">rhs</span> <span class="p">=</span> <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">o</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">o</span><span class="p">.</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lhs</span> <span class="o">-</span> <span class="n">rhs</span>
<span class="p">}</span>

<span class="c1">/// Calculate and return the convex hull of a given sequence of points.</span>
<span class="c1">///</span>
<span class="c1">/// - Remark: Implements Andrew’s monotone chain convex hull algorithm.</span>
<span class="c1">///</span>
<span class="c1">/// - Complexity: O(*n* log *n*), where *n* is the count of `points`.</span>
<span class="c1">///</span>
<span class="c1">/// - Parameter points: A sequence of `CGPoint` elements.</span>
<span class="c1">///</span>
<span class="c1">/// - Returns: An array containing the convex hull of `points`, ordered</span>
<span class="c1">///   lexicographically from the smallest coordinates to the largest,</span>
<span class="c1">///   turning counterclockwise.</span>
<span class="c1">///</span>
<span class="kd">public</span> <span class="kd">func</span> <span class="nf">convexHull</span><span class="p">&lt;</span><span class="n">Source</span><span class="p">&gt;(</span><span class="kc">_</span> <span class="n">points</span><span class="p">:</span> <span class="n">Source</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="p">[</span><span class="bp">CGPoint</span><span class="p">]</span>
    <span class="k">where</span> <span class="n">Source</span> <span class="p">:</span> <span class="n">Collection</span><span class="p">,</span>
          <span class="n">Source</span><span class="p">.</span><span class="n">Element</span> <span class="p">==</span> <span class="bp">CGPoint</span>
<span class="p">{</span>
    <span class="c1">// Exit early if there aren’t enough points to work with.</span>
    <span class="k">guard</span> <span class="n">points</span><span class="p">.</span><span class="bp">count</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="nb">Array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="p">}</span>

    <span class="c1">// Create storage for the lower and upper hulls.</span>
    <span class="kd">var</span> <span class="nv">lower</span> <span class="p">=</span> <span class="p">[</span><span class="bp">CGPoint</span><span class="p">]()</span>
    <span class="kd">var</span> <span class="nv">upper</span> <span class="p">=</span> <span class="p">[</span><span class="bp">CGPoint</span><span class="p">]()</span>

    <span class="c1">// Sort points in lexicographical order.</span>
    <span class="kd">let</span> <span class="nv">points</span> <span class="p">=</span> <span class="n">points</span><span class="p">.</span><span class="bp">sorted</span> <span class="p">{</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="k">in</span>
        <span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">||</span> <span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="p">==</span> <span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">.</span><span class="n">y</span>
    <span class="p">}</span>

    <span class="c1">// Construct the lower hull.</span>
    <span class="k">for</span> <span class="n">point</span> <span class="k">in</span> <span class="n">points</span> <span class="p">{</span>
        <span class="k">while</span> <span class="n">lower</span><span class="p">.</span><span class="bp">count</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nv">a</span> <span class="p">=</span> <span class="n">lower</span><span class="p">[</span><span class="n">lower</span><span class="p">.</span><span class="bp">count</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
            <span class="kd">let</span> <span class="nv">b</span> <span class="p">=</span> <span class="n">lower</span><span class="p">[</span><span class="n">lower</span><span class="p">.</span><span class="bp">count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">cross</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">{</span> <span class="k">break</span> <span class="p">}</span>
            <span class="n">lower</span><span class="p">.</span><span class="bp">removeLast</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">lower</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Construct the upper hull.</span>
    <span class="k">for</span> <span class="n">point</span> <span class="k">in</span> <span class="n">points</span><span class="p">.</span><span class="kr">lazy</span><span class="p">.</span><span class="n">reversed</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">while</span> <span class="n">upper</span><span class="p">.</span><span class="bp">count</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nv">a</span> <span class="p">=</span> <span class="n">upper</span><span class="p">[</span><span class="n">upper</span><span class="p">.</span><span class="bp">count</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
            <span class="kd">let</span> <span class="nv">b</span> <span class="p">=</span> <span class="n">upper</span><span class="p">[</span><span class="n">upper</span><span class="p">.</span><span class="bp">count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">cross</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">{</span> <span class="k">break</span> <span class="p">}</span>
            <span class="n">upper</span><span class="p">.</span><span class="bp">removeLast</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">upper</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Remove each array’s last point, as it’s the same as the first point</span>
    <span class="c1">// in the opposite array, respectively.</span>
    <span class="n">lower</span><span class="p">.</span><span class="bp">removeLast</span><span class="p">()</span>
    <span class="n">upper</span><span class="p">.</span><span class="bp">removeLast</span><span class="p">()</span>

    <span class="c1">// Join the arrays to form the convex hull.</span>
    <span class="k">return</span> <span class="n">lower</span> <span class="o">+</span> <span class="n">upper</span>
<span class="p">}</span>
</pre></div>
<h2><span class="mw-headline" id="References">References</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit&amp;section=16" title="Edit section: References">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li>De Berg, van Kreveld, Overmars, Schwarzkopf. Computational Geometry: Algorithms and Applications. 2nd edition, Springer-Verlag. <a href="https://en.wikibooks.org/wiki/Special:BookSources/3540656200" title="Special:BookSources/3540656200">ISBN 3540656200</a>.</li>
<li>Dan Sunday. <a rel="nofollow" class="external text" href="http://softsurfer.com/Archive/algorithm_0109/algorithm_0109.htm">The Convex Hull of a 2D Point Set or Polygon</a>. (<a rel="nofollow" class="external text" href="http://www.webcitation.org/5uY0uFNqR">archived copy</a> by webcite)</li>
<li>A. M. Andrew, "Another Efficient Algorithm for Convex Hulls in Two Dimensions", Info. Proc. Letters 9, 216-219 (1979).</li></ul>

<!-- 
NewPP limit report
Parsed by mw1325
Cached time: 20190227175903
Cache expiry: 2592000
Dynamic content: false
CPU time usage: 0.204 seconds
Real time usage: 0.260 seconds
Preprocessor visited node count: 247/1000000
Preprocessor generated node count: 0/1500000
Post‐expand include size: 855/2097152 bytes
Template argument size: 566/2097152 bytes
Highest expansion depth: 10/40
Expensive parser function count: 0/500
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 125140/5000000 bytes
Number of Wikibase entities loaded: 0/400
Lua time usage: 0.022/10.000 seconds
Lua memory usage: 918 KB/50 MB
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   60.992      1 -total
 60.90%   37.141      1 Template:BookCat
 38.91%   23.732      1 Template:ISBN
 20.11%   12.263      1 Template:Evalx
  9.35%    5.702      1 Template:BOOKCATEGORY
  5.99%    3.654      1 Template:NAIVEBOOKNAME
-->

<!-- Saved in parser cache with key enwikibooks:pcache:idhash:244493-0!canonical!math=5 and timestamp 20190227175903 and revision id 3509164
 -->
</div><noscript><img src="//en.wikibooks.org/wiki/Special:CentralAutoLogin/start?type=1x1" alt="" title="" width="1" height="1" style="border: none; position: absolute;" /></noscript></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;oldid=3509164">https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;oldid=3509164</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="https://en.wikibooks.org/wiki/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="https://en.wikibooks.org/wiki/Category:Book:Algorithm_Implementation" title="Category:Book:Algorithm Implementation">Book:Algorithm Implementation</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-anonuserpage">Not logged in</li><li id="pt-anontalk"><a href="https://en.wikibooks.org/wiki/Special:MyTalk" title="Discussion about edits from this IP address [alt-shift-n]" accesskey="n">Discussion for this IP address</a></li><li id="pt-anoncontribs"><a href="https://en.wikibooks.org/wiki/Special:MyContributions" title="A list of edits made from this IP address [alt-shift-y]" accesskey="y">Contributions</a></li><li id="pt-createaccount"><a href="https://en.wikibooks.org/w/index.php?title=Special:CreateAccount&amp;returnto=Algorithm+Implementation%2FGeometry%2FConvex+hull%2FMonotone+chain" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="https://en.wikibooks.org/w/index.php?title=Special:UserLogin&amp;returnto=Algorithm+Implementation%2FGeometry%2FConvex+hull%2FMonotone+chain" title="You are encouraged to log in; however, it is not mandatory [alt-shift-o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain" title="View the content page [alt-shift-c]" accesskey="c">Book</a></span></li><li id="ca-talk"><span><a href="https://en.wikibooks.org/wiki/Talk:Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain" rel="discussion" title="Discussion about the content page [alt-shift-t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label">
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<ul class="menu">
													</ul>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain">Read</a></span></li><li id="ca-edit" class="collapsible"><span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=edit" title="Edit this page [alt-shift-e]" accesskey="e">Edit</a></span></li><li id="ca-history" class="collapsible"><span><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=history" title="Past revisions of this page [alt-shift-h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label" style="">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label">
						<h3 id="p-cactions-label"><span>More</span></h3>
						<ul class="menu">
													</ul>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="https://en.wikibooks.org/w/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search Wikibooks" title="Search Wikibooks [alt-shift-f]" accesskey="f" id="searchInput" tabindex="1" autocomplete="off"><input type="hidden" value="Special:Search" name="title"><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton">							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="https://en.wikibooks.org/wiki/Main_Page" title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-Navigation" aria-labelledby="p-Navigation-label">
			<h3 id="p-Navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage"><a href="https://en.wikibooks.org/wiki/Main_Page" title="Visit the main page [alt-shift-z]" accesskey="z">Main Page</a></li><li id="n-help"><a href="https://en.wikibooks.org/wiki/Help:Contents" title="Find help on how to use and edit Wikibooks">Help</a></li><li id="n-Browse"><a href="https://en.wikibooks.org/wiki/Wikibooks:Card_Catalog_Office" title="Check out what Wikibooks has to offer">Browse</a></li><li id="n-Cookbook"><a href="https://en.wikibooks.org/wiki/Cookbook:Table_of_Contents" title="Learn recipes from around the world">Cookbook</a></li><li id="n-Wikijunior"><a href="https://en.wikibooks.org/wiki/Wikijunior" title="Books for children">Wikijunior</a></li><li id="n-Featured-books"><a href="https://en.wikibooks.org/wiki/Wikibooks:Featured_books" title="The best of Wikibooks">Featured books</a></li><li id="n-recentchanges"><a href="https://en.wikibooks.org/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [alt-shift-r]" accesskey="r">Recent changes</a></li><li id="n-sitesupport"><a href="https://donate.wikimedia.org/wiki/Special:FundraiserRedirector?utm_source=donate&amp;utm_medium=sidebar&amp;utm_campaign=C13_en.wikibooks.org&amp;uselang=en" title="Support Wikibooks">Donations</a></li><li id="n-randomrootpage"><a href="https://en.wikibooks.org/wiki/Special:RandomInCategory/Book:Wikibooks_Stacks/Books">Random book</a></li><li id="n-Using-Wikibooks"><a href="https://en.wikibooks.org/wiki/Using_Wikibooks">Using Wikibooks</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-Community" aria-labelledby="p-Community-label">
			<h3 id="p-Community-label">Community</h3>
			<div class="body">
								<ul>
					<li id="n-Reading-room"><a href="https://en.wikibooks.org/wiki/Wikibooks:Reading_room" title="Discuss Wikibooks-related questions and concerns with others">Reading room</a></li><li id="n-portal"><a href="https://en.wikibooks.org/wiki/Wikibooks:Community_Portal" title="Find your way around the Wikibooks community">Community portal</a></li><li id="n-currentevents"><a href="https://en.wikibooks.org/wiki/Wikibooks:Reading_room/Bulletin_Board" title="Important community news">Bulletin Board</a></li><li id="n-maintenance"><a href="https://en.wikibooks.org/wiki/Wikibooks:Maintenance" title="Frequent tasks that you can help with">Help out!</a></li><li id="n-Policies-and-guidelines"><a href="https://en.wikibooks.org/wiki/Wikibooks:Policies_and_guidelines" title="Pages detailing important rules and procedures">Policies and guidelines</a></li><li id="n-contact"><a href="https://en.wikibooks.org/wiki/Wikibooks:Contact_us" title="Alternative methods of communication">Contact us</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Tools</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="https://en.wikibooks.org/wiki/Special:WhatLinksHere/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain" title="A list of all wiki pages that link here [alt-shift-j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="https://en.wikibooks.org/wiki/Special:RecentChangesLinked/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain" rel="nofollow" title="Recent changes in pages linked from this page [alt-shift-k]" accesskey="k">Related changes</a></li><li id="t-upload"><a href="https://commons.wikimedia.org/wiki/Special:UploadWizard?uselang=en" title="Upload files [alt-shift-u]" accesskey="u">Upload file</a></li><li id="t-specialpages"><a href="https://en.wikibooks.org/wiki/Special:SpecialPages" title="A list of all special pages [alt-shift-q]" accesskey="q">Special pages</a></li><li id="t-permalink"><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;oldid=3509164" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;action=info" title="More information about this page">Page information</a></li><li id="t-cite"><a href="https://en.wikibooks.org/w/index.php?title=Special:CiteThisPage&amp;page=Algorithm_Implementation%2FGeometry%2FConvex_hull%2FMonotone_chain&amp;id=3509164" title="Information on how to cite this page">Cite this page</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-lang" aria-labelledby="p-lang-label"><button class="uls-settings-trigger" title="Language settings"></button>
			<h3 id="p-lang-label">Languages</h3>
			<div class="body">
								<ul>
									</ul>
				<div class="after-portlet after-portlet-lang"><span class="wb-langlinks-add wb-langlinks-link"><a href="https://www.wikidata.org/wiki/Special:NewItem?site=enwikibooks&amp;page=Algorithm+Implementation%2FGeometry%2FConvex+hull%2FMonotone+chain" title="Add interlanguage links" class="wbc-editpage">Add links</a></span></div>			</div>
		</div>
			<div class="portal" role="navigation" id="p-Sister_projects" aria-labelledby="p-Sister_projects-label">
			<h3 id="p-Sister_projects-label">Sister projects</h3>
			<div class="body">
								<ul>
					<li id="n-Wikipedia"><a href="https://en.wikipedia.org/wiki/Main_Page">Wikipedia</a></li><li id="n-Wikiversity"><a href="https://en.wikiversity.org/wiki/Wikiversity:Main_Page">Wikiversity</a></li><li id="n-Wiktionary"><a href="https://en.wiktionary.org/wiki/Wiktionary:Main_Page">Wiktionary</a></li><li id="n-Wikiquote"><a href="https://en.wikiquote.org/wiki/Main_Page">Wikiquote</a></li><li id="n-Wikisource"><a href="https://en.wikisource.org/wiki/Main_Page">Wikisource</a></li><li id="n-Wikinews"><a href="https://en.wikinews.org/wiki/Main_Page">Wikinews</a></li><li id="n-Wikivoyage"><a href="https://en.wikivoyage.org/wiki/Main_Page">Wikivoyage</a></li><li id="n-Commons"><a href="https://commons.wikimedia.org/wiki/Main_Page">Commons</a></li><li id="n-Wikidata"><a href="https://www.wikidata.org/wiki/Wikidata:Main_Page">Wikidata</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-coll-print_export" aria-labelledby="p-coll-print_export-label">
			<h3 id="p-coll-print_export-label">Print/export</h3>
			<div class="body">
								<ul>
					<li id="coll-create_a_book"><a href="https://en.wikibooks.org/w/index.php?title=Special:Book&amp;bookcmd=book_creator&amp;referer=Algorithm+Implementation%2FGeometry%2FConvex+hull%2FMonotone+chain">Create a collection</a></li><li id="coll-download-as-rdf2latex"><a href="https://en.wikibooks.org/w/index.php?title=Special:ElectronPdf&amp;page=Algorithm+Implementation%2FGeometry%2FConvex+hull%2FMonotone+chain&amp;action=show-download-screen">Download as PDF</a></li><li id="t-print"><a href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;printable=yes" title="Printable version of this page [alt-shift-p]" accesskey="p">Printable version</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 11 January 2019, at 12:02.</li>
								<li id="footer-info-copyright">Text is available under the <a href="https://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike License.</a>; additional terms may apply.  By using this site, you agree to the <a href="https://wikimediafoundation.org/wiki/Terms_of_Use">Terms of Use</a> and <a href="https://wikimediafoundation.org/wiki/Privacy_policy">Privacy Policy.</a></li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="https://foundation.wikimedia.org/wiki/Privacy_policy" class="extiw" title="wmf:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="https://en.wikibooks.org/wiki/Wikibooks:Welcome" title="Wikibooks:Welcome">About Wikibooks</a></li>
								<li id="footer-places-disclaimer"><a href="https://en.wikibooks.org/wiki/Wikibooks:General_disclaimer" title="Wikibooks:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-developers"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/How_to_contribute">Developers</a></li>
								<li id="footer-places-cookiestatement"><a href="https://foundation.wikimedia.org/wiki/Cookie_statement">Cookie statement</a></li>
								<li id="footer-places-mobileview"><a href="https://en.m.wikibooks.org/w/index.php?title=Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="https://wikimediafoundation.org/"><img src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/wikimedia-button.png" srcset="/static/images/wikimedia-button-1.5x.png 1.5x, /static/images/wikimedia-button-2x.png 2x" width="88" height="31" alt="Wikimedia Foundation"></a>					</li>
										<li id="footer-poweredbyico">
						<a href="https://www.mediawiki.org/"><img src="./4 - Algorithm Implementation_Geometry_Convex hull_Monotone chain - Wikibooks, open books for an open world_files/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/static/images/poweredby_mediawiki_132x47.png 1.5x, /static/images/poweredby_mediawiki_176x62.png 2x" width="88" height="31"></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.204","walltime":"0.260","ppvisitednodes":{"value":247,"limit":1000000},"ppgeneratednodes":{"value":0,"limit":1500000},"postexpandincludesize":{"value":855,"limit":2097152},"templateargumentsize":{"value":566,"limit":2097152},"expansiondepth":{"value":10,"limit":40},"expensivefunctioncount":{"value":0,"limit":500},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":125140,"limit":5000000},"entityaccesscount":{"value":0,"limit":400},"timingprofile":["100.00%   60.992      1 -total"," 60.90%   37.141      1 Template:BookCat"," 38.91%   23.732      1 Template:ISBN"," 20.11%   12.263      1 Template:Evalx","  9.35%    5.702      1 Template:BOOKCATEGORY","  5.99%    3.654      1 Template:NAIVEBOOKNAME"]},"scribunto":{"limitreport-timeusage":{"value":"0.022","limit":"10.000"},"limitreport-memusage":{"value":940048,"limit":52428800}},"cachereport":{"origin":"mw1325","timestamp":"20190227175903","ttl":2592000,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":98,"wgHostname":"mw1242"});});</script>
	

<div class="suggestions" style="display: none; font-size: 13px;"><div class="suggestions-results"></div><div class="suggestions-special"></div></div></body></html>